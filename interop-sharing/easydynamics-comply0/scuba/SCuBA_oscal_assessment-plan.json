{
  "assessment-plan" : {
    "import-ssp" : {
      "href" : "#080172e1-3306-4f73-99b6-c1facbc21077"
    },
    "back-matter" : {
      "resources" : [ {
        "uuid" : "080172e1-3306-4f73-99b6-c1facbc21077",
        "rlinks" : [ {
          "href" : "./ssp.xml",
          "media-type" : "application/xml"
        }, {
          "href" : "./ssp.json",
          "media-type" : "application/json"
        }, {
          "href" : "./ssp.yaml",
          "media-type" : "application/yaml"
        } ],
        "title" : "\\[System Name\\] SSP",
        "props" : [ {
          "name" : "type",
          "ns" : "http://comply0.com/ns/oscal",
          "value" : "system-security-plan"
        } ]
      }, {
        "uuid" : "6392cc05-4bc6-4aaf-97b1-c758d9978f58",
        "rlinks" : [ {
          "href" : "https://raw.githubusercontent.com/usnistgov/oscal-content/refs/tags/v1.4.0/nist.gov/SP800-53/rev5/xml/NIST_SP-800-53_rev5_catalog.xml",
          "media-type" : "application/xml"
        }, {
          "href" : "https://raw.githubusercontent.com/usnistgov/oscal-content/refs/tags/v1.4.0/nist.gov/SP800-53/rev5/json/NIST_SP-800-53_rev5_catalog.json",
          "media-type" : "application/json"
        }, {
          "href" : "https://raw.githubusercontent.com/usnistgov/oscal-content/refs/tags/v1.4.0/nist.gov/SP800-53/rev5/yaml/NIST_SP-800-53_rev5_catalog.yaml",
          "media-type" : "application/yaml"
        } ],
        "title" : "NIST SP 800-53r5",
        "props" : [ {
          "name" : "version",
          "value" : "Revision 5"
        } ]
      } ]
    },
    "metadata" : {
      "published" : "2025-12-08T12:00:00-04:00",
      "roles" : [ {
        "id" : "author",
        "title" : "Content Author"
      } ],
      "title" : "CISA SCuBA Assessment Plan",
      "last-modified" : "2025-12-08T12:00:00-04:00",
      "oscal-version" : "1.1.3",
      "parties" : [ {
        "name" : "Easy Dynamics",
        "uuid" : "33da91b4-3178-49d6-babb-948c9542fd13",
        "links" : [ {
          "href" : "https://easydynamics.com"
        } ],
        "type" : "organization"
      } ],
      "version" : "EXPERIMENTAL"
    },
    "reviewed-controls" : {
      "control-selections" : [ {
        "include-all" : { }
      } ]
    },
    "uuid" : "d4f5c3e2-5b6a-4c3e-9f7a-123456789abc",
    "local-definitions" : {
      "activities" : [ {
        "uuid" : "af5e87fd-8130-4f2b-9cb5-9c8c045df1d6",
        "title" : "Legacy authentication SHALL be blocked.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad11v1"
        }, {
          "text" : "Block legacy authentication with Conditional Access",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/conditional-access/howto-conditional-access-policy-block-legacy"
        }, {
          "text" : "Five steps to securing your identity infrastructure",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/azure/security/fundamentals/steps-secure-identity"
        }, {
          "text" : "T1110: Brute Force",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/"
        }, {
          "text" : "T1110.001: Password Guessing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/001/"
        }, {
          "text" : "T1110.002: Password Cracking",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/002/"
        }, {
          "text" : "T1110.003: Password Spraying",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/003/"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.1.1v1"
          } ],
          "description" : "[Determine if an agency’s existing applications use legacy authentication](https://learn.microsoft.com/en-us/entra/identity/conditional-access/block-legacy-authentication#identify-legacy-authentication-use) before blocking legacy authentication across the entire application base.",
          "uuid" : "39c6b854-cd9d-4764-b29b-e7de1f28b85a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.1.1v1"
          } ],
          "description" : "Create a Conditional Access policy to block legacy authentication\n\n```\nUsers > Include > All users Target resources > Include > All resources (formerly 'All cloud apps')  Conditions > Client apps > Configure > Yes > Legacy authentication clients > Select only Exchange ActiveSync clients and Other clients Access controls > Grant > Block Access \n```",
          "uuid" : "64cee18d-fe38-4c80-a298-e14906f22b0f"
        } ],
        "description" : "The security risk of allowing legacy authentication protocols is they do not support MFA. Blocking legacy protocols reduces the impact of user credential theft.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.1.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "40c75474-78e5-44b2-9aef-b5fc80f392ee",
        "title" : "Users detected as high risk SHALL be blocked.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad21v1"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.2.1v1"
          } ],
          "description" : "Create a conditional access policy blocking users categorized as high risk by the Identity Protection service. Configure the following policy settings in the new conditional access policy as per the values below:\n\n```\nUsers > Include > All users Target resources > Include > All resources (formerly 'All cloud apps')  Conditions > User risk > High Access controls > Grant > Block Access \n```",
          "uuid" : "9a73db50-9da9-4e5e-9510-e8bc3a44b7a9"
        } ],
        "description" : "Blocking high-risk users may prevent compromised accounts from accessing the tenant.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.2.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2.12",
              "statement-ids" : [ "ac-2.12_smt" ]
            }, {
              "control-id" : "ac-2.13",
              "statement-ids" : [ "ac-2.13_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "21849cc6-d907-4eda-a0a2-3ab24421590a",
        "title" : "A notification SHOULD be sent to the administrator when high-risk users are detected.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad22v1"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.2.2v1"
          } ],
          "description" : "[Configure Microsoft Entra ID Protection to send a regularly monitored security mailbox email notification](https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-configure-notifications#configure-users-at-risk-detected-alerts) when user accounts are determined to be high risk.",
          "uuid" : "de6937f7-655b-49e5-bbfe-d2ab0738b16a"
        } ],
        "description" : "Notification enables the admin to monitor the event and remediate the risk. This helps the organization proactively respond to cyber intrusions as they occur.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.2.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2.12",
              "statement-ids" : [ "ac-2.12_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "7de4db86-3867-431d-9230-7957afa9c3c2",
        "title" : "Sign-ins detected as high risk SHALL be blocked.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad23v1"
        }, {
          "text" : "What are risk detections?",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-risks"
        }, {
          "text" : "Simulating risk detections in Identity Protection",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/id-protection/howto-identity-protection-simulate-risk"
        }, {
          "text" : "Self-remediation experience with Microsoft Entra ID Protection and Conditional Access",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/id-protection/concept-identity-protection-user-experience"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.2.3v1"
          } ],
          "description" : "Create a Conditional Access policy blocking sign-ins determined high risk by the Identity Protection service. Configure the following policy settings in the new Conditional Access policy as per the values below:\n\n```\nUsers > Include > All users Target resources > Include > All resources (formerly 'All cloud apps')  Conditions > Sign-in risk > High Access controls > Grant > Block Access \n```",
          "uuid" : "00b27c80-c9d9-41ca-baa4-e3e8186922b5"
        } ],
        "description" : "This prevents compromised accounts from accessing the tenant.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.2.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2.12",
              "statement-ids" : [ "ac-2.12_smt" ]
            }, {
              "control-id" : "ac-2.13",
              "statement-ids" : [ "ac-2.13_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "8040ef7f-889c-4535-81d4-4d308d59ef2b",
        "title" : "Phishing-resistant MFA SHALL be enforced for all users.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad31v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.1v1"
          } ],
          "description" : "Create a conditional access policy enforcing phishing-resistant MFA for all users. Configure the following policy settings in the new conditional access policy, per the values below:\n\n```\nUsers > Include > All users Target resources > Include > All resources (formerly 'All cloud apps')  Access controls > Grant > Grant Access > Require authentication strength > Phishing-resistant MFA \n```",
          "uuid" : "23231256-601f-4bdb-a171-977a2bd35535"
        } ],
        "description" : "Weaker forms of MFA do not protect against sophisticated phishing attacks. By enforcing methods resistant to phishing, those risks are minimized.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ia-2.1",
              "statement-ids" : [ "ia-2.1_smt" ]
            }, {
              "control-id" : "ia-2.2",
              "statement-ids" : [ "ia-2.2_smt" ]
            }, {
              "control-id" : "ia-5",
              "statement-ids" : [ "ia-5_smt.c", "ia-5_smt.g" ]
            }, {
              "control-id" : "ia-2.8",
              "statement-ids" : [ "ia-2.8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "05dbce89-0307-4d5b-b116-e300bc016843",
        "title" : "If phishing-resistant MFA has not been enforced, an alternative MFA method SHALL be enforced for all users.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad32v1"
        }, {
          "text" : "T1110: Brute Force",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/"
        }, {
          "text" : "T1110.001: Password Guessing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/001/"
        }, {
          "text" : "T1110.002: Password Cracking",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/002/"
        }, {
          "text" : "T1110.003: Password Spraying",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.2v1"
          } ],
          "description" : "If phishing-resistant MFA has not been enforced for all users yet, create a conditional access policy that enforces MFA but does not dictate MFA method. Configure the following policy settings in the new conditional access policy, per the values below:\n\n```\nUsers > Include > All users Target resources > Include > All resources (formerly 'All cloud apps')  Access controls > Grant > Grant Access > Require multifactor authentication \n```",
          "uuid" : "367b9426-f10a-4b99-baab-8c8a43840a36"
        } ],
        "description" : "This is a stopgap security policy to help protect the tenant if phishing-resistant MFA has not been enforced. This policy requires MFA enforcement, thus reducing single-form authentication risk.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ia-2.1",
              "statement-ids" : [ "ia-2.1_smt" ]
            }, {
              "control-id" : "ia-2.2",
              "statement-ids" : [ "ia-2.2_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d79e5d72-b4b0-4d4e-9630-a19d8c05faee",
        "title" : "If Microsoft Authenticator is enabled, it SHALL be configured to show login context information.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad33v2"
        }, {
          "text" : "T1110: Brute Force",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/"
        }, {
          "text" : "T1110.001: Password Guessing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/001/"
        }, {
          "text" : "T1110.002: Password Cracking",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/002/"
        }, {
          "text" : "T1110.003: Password Spraying",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1110/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.3v2"
          } ],
          "description" : "If Microsoft Authenticator is in use, configure Authenticator to display context information to users when they log in.",
          "uuid" : "652423d9-05b4-43e6-96f6-127416d35208"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.3v2"
          } ],
          "description" : "In **Microsoft Entra admin center** , click **Protection \\> Authentication methods \\> Microsoft Authenticator** . 2. Click the **Configure** tab. 3. For **Allow use of Microsoft Authenticator OTP** select *No* . 4. Under **Show application name in push and passwordless notifications** select **Status \\> Enabled** and **Target \\> Include \\> All users** . 5. Under **Show geographic location in push and passwordless notifications** select **Status \\> Enabled** and **Target \\> Include \\> All users** . 6. Select **Save**",
          "uuid" : "7cfcfeaa-169b-48cd-9068-57e498c6e2ec"
        } ],
        "description" : "This policy helps protect the tenant when Microsoft Authenticator is used by showing user context information, which helps reduce MFA phishing compromises.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.3v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ia-2.1",
              "statement-ids" : [ "ia-2.1_smt" ]
            }, {
              "control-id" : "ia-2.2",
              "statement-ids" : [ "ia-2.2_smt" ]
            }, {
              "control-id" : "ia-5",
              "statement-ids" : [ "ia-5_smt.c", "ia-5_smt.g" ]
            }, {
              "control-id" : "ia-2.8",
              "statement-ids" : [ "ia-2.8_smt" ]
            }, {
              "control-id" : "ia-2.13",
              "statement-ids" : [ "ia-2.13_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "6dcdeee0-c1aa-4cdb-b73d-758069793c7b",
        "title" : "The Authentication Methods Manage Migration feature SHALL be set to Migration Complete.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad34v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.4v1"
          } ],
          "description" : "Go through the process of [How to migrate MFA and SSPR policy settings to the Authentication methods policy for Microsoft Entra ID](https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-authentication-methods-manage). 2. Once ready to finish the migration, [set the **Manage Migration** option to **Migration Complete**](https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-authentication-methods-manage#finish-the-migration).",
          "uuid" : "c2f3fb07-25b1-4936-91d0-1b10c735e149"
        } ],
        "description" : "To disable the legacy authentication methods screen for the tenant, configure the Manage Migration feature to Migration Complete. The MFA and Self-Service Password Reset (SSPR) authentication methods are both managed from a central admin page, thereby reducing administrative complexity and potential security misconfigurations.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d21d0059-07a7-4f72-abbf-bae27b8953bd",
        "title" : "The authentication methods SMS, Voice Call, and Email One-Time Passcode (OTP) SHALL be disabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad35v1"
        }, {
          "text" : "T1621: Multi-Factor Authentication Request Generation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1621/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.5v1"
          } ],
          "description" : "In **Microsoft Entra admin center** , click **Protection \\> Authentication methods** 2. Click on the **SMS** , **Voice Call** , and **Email OTP** authentication methods and disable each of them. Their statuses should be **Enabled \\> No** on the **Authentication methods \\> Policies** page.",
          "uuid" : "476ba206-6f06-40cf-8786-437b46ac1d88"
        } ],
        "description" : "SMS, voice call, and email OTP are the weakest authenticators. This policy forces users to use stronger MFA methods.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.5v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt.b" ]
            }, {
              "control-id" : "ia-5",
              "statement-ids" : [ "ia-5_smt.c" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "e131c7fb-9073-4a7b-9bd7-f71928a181e6",
        "title" : "Phishing-resistant MFA SHALL be required for highly privileged roles.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad36v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.6v1"
          } ],
          "description" : "Create a conditional access policy enforcing phishing-resistant MFA for highly privileged roles. Configure the following policy settings in the new conditional access policy, per the values below:\n\n```\nUsers > Include > Select users and groups > Directory roles > select each of the roles listed in the Highly Privileged Roles section at the top of this document Target resources > Include > All resources (formerly 'All cloud apps')  Access controls > Grant > Grant Access > Require authentication strength > Phishing-resistant MFA \n```",
          "uuid" : "cc623378-e54d-43ce-8995-6888650de7b7"
        } ],
        "description" : "This is a backup security policy to help protect privileged access to the tenant if the conditional access policy, which requires MFA for all users, is disabled or misconfigured.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.6v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ia-2.1",
              "statement-ids" : [ "ia-2.1_smt" ]
            }, {
              "control-id" : "ia-5",
              "statement-ids" : [ "ia-5_smt.c", "ia-5_smt.g" ]
            }, {
              "control-id" : "ia-2.8",
              "statement-ids" : [ "ia-2.8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "268ca830-7888-4be4-9584-619efd82e8e3",
        "title" : "Managed devices SHOULD be required for authentication.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad37v1"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.7v1"
          } ],
          "description" : "Create a conditional access policy requiring a user's device to be either Microsoft Entra ID hybrid joined or compliant during authentication. Configure the following policy settings in the new conditional access policy, per the values below:\n\n```\nUsers > Include > All users Target resources > Include > All resources (formerly 'All cloud apps')  Access controls > Grant > Grant Access > Require device to be marked as compliant and Require Microsoft Entra ID hybrid joined device > For multiple controls > Require one of the selected controls \n```",
          "uuid" : "e44a55a9-7f95-464e-91c8-3c6f56265b0b"
        } ],
        "description" : "The security risk of an adversary authenticating to the tenant from their own device is reduced by requiring a managed device to authenticate. Managed devices are under the provisioning and control of the agency. [OMB-22-09](https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf) states, \"When authorizing users to access resources, agencies must consider at least one device-level signal alongside identity information about the authenticated user.\"",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.7v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-20",
              "statement-ids" : [ "ac-20_smt.b" ]
            }, {
              "control-id" : "ia-3",
              "statement-ids" : [ "ia-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "f952b68a-ec19-4712-9f5e-9f1a912e5e24",
        "title" : "Managed Devices SHOULD be required to register MFA.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad38v1"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.005: Device Registration",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/005/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.8v1"
          } ],
          "description" : "Create a conditional access policy requiring a user to be on a managed device when registering for MFA. Configure the following policy settings in the new conditional access policy, per the values below:\n\n```\nUsers > Include > All users Target resources > User actions > Register security information Access controls > Grant > Grant Access > Require device to be marked as compliant and Require Microsoft Entra ID hybrid joined device > For multiple controls > Require one of the selected controls \n```",
          "uuid" : "5b342971-02c4-4652-b1d5-69384b74a71e"
        } ],
        "description" : "Reduce risk of an adversary using stolen user credentials and then registering their own MFA device to access the tenant by requiring a managed device provisioned and controlled by the agency to perform registration actions. This prevents the adversary from using their own unmanaged device to perform the registration.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.8v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-20",
              "statement-ids" : [ "ac-20_smt.b" ]
            }, {
              "control-id" : "ia-3",
              "statement-ids" : [ "ia-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "c0a83940-a40d-47f1-9f53-c648de977ab8",
        "title" : "Device code authentication SHOULD be blocked.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad39v1"
        }, {
          "text" : "What authentication and verification methods are available in Microsoft Entra ID?",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-authentication-methods"
        }, {
          "text" : "Use additional context in Authenticator notifications - Authentication methods policy",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-mfa-additional-context#enable-additional-context-in-the-portal"
        }, {
          "text" : "M-22-09 Federal Zero Trust Architecture Strategy",
          "rel" : "reference",
          "href" : "https://www.whitehouse.gov/wp-content/uploads/2022/01/M-22-09.pdf"
        }, {
          "text" : "Configure Microsoft Entra hybrid join",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/devices/how-to-hybrid-join"
        }, {
          "text" : "Microsoft Entra joined devices",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/devices/concept-directory-join"
        }, {
          "text" : "Set up automatic enrollment for Windows devices (for Intune)",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/mem/intune/enrollment/windows-enroll"
        }, {
          "text" : "Enable passkeys (FIDO2) for your organization",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/authentication/how-to-enable-passkey-fido2"
        }, {
          "text" : "Storm-2372 conducts device code phishing campaign",
          "rel" : "reference",
          "href" : "https://www.microsoft.com/en-us/security/blog/2025/02/13/storm-2372-conducts-device-code-phishing-campaign/"
        }, {
          "text" : "Microsoft 365 Device Code Phishing Cyber Attack – Demonstration, Analysis and Mitigation",
          "rel" : "reference",
          "href" : "https://github.com/cisagov/ScubaGear/issues/1599"
        }, {
          "text" : "Block device code flow",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/conditional-access/managed-policies#block-device-code-flow"
        }, {
          "text" : "T1528: Steal Application Access Token",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1528/"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.3.9v1"
          } ],
          "description" : "Create a Conditional Access policy to block device code flow\n\n```\nUsers > Include > All users Target resources > Include > All resources (formerly 'All cloud apps')  Conditions > Authentication Flows > Configure > Yes > Select Device code flow Access controls > Grant > Block Access \n```",
          "uuid" : "76d5d048-88b3-47d5-8fd8-6411ad8e0738"
        } ],
        "description" : "The device code authentication flow has been abused to compromise user accounts via phishing. Since most organizations using M365 don't need device code authentication, blocking it mitigates the risk.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.3.9v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "93d591f2-a295-4455-b2ab-8f6862fb03ad",
        "title" : "Security logs SHALL be sent to the agency's security operations center for monitoring.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad41v1"
        }, {
          "text" : "Everything you wanted to know about Security and Audit Logging in Office 365",
          "rel" : "reference",
          "href" : "https://thecloudtechnologist.com/2021/10/15/everything-you-wanted-to-know-about-security-and-audit-logging-in-office-365/"
        }, {
          "text" : "What are Microsoft Entra sign-in logs??",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/monitoring-health/concept-sign-ins"
        }, {
          "text" : "National Cybersecurity Protection System-Cloud Interface Reference Architecture Volume One: General Guidance",
          "rel" : "reference",
          "href" : "https://www.cisa.gov/sites/default/files/publications/NCPS%20Cloud%20Interface%20RA%20Volume%20One%20%282021-05-14%29.pdf"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.008: Disable or Modify Cloud Logs",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/008/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.4.1v1"
          } ],
          "description" : "Follow the configuration instructions unique to the products and integration patterns at your organization to send the security logs to the security operations center for monitoring.",
          "uuid" : "60a7ae88-b913-4457-88ab-b1bf03101859"
        } ],
        "description" : "The security risk of not having visibility into cyber attacks is reduced by collecting logs in the agency’s centralized security detection infrastructure. This makes security events available for auditing, query, and incident response.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.4.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "au-4",
              "statement-ids" : [ "au-4_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "368c5619-dc32-4e4f-8e3a-0de132e10bc8",
        "title" : "Only administrators SHALL be allowed to register applications.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad51v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.001: Additional Cloud Credentials",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/001/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.1v1"
          } ],
          "description" : "In **Microsoft Entra admin center** , select **Users**.",
          "uuid" : "524359bc-47e0-4683-8d37-6a6ff0e99a14"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.1v1"
          } ],
          "description" : "Select **User settings**.",
          "uuid" : "dcf3dc2f-6795-4a10-9f1e-fcb196fe3c55"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.1v1"
          } ],
          "description" : "For **Users can register applications** , select **No**.",
          "uuid" : "8bd0221a-a64a-4611-8529-08e7ac321a5f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.1v1"
          } ],
          "description" : "Click **Save**.",
          "uuid" : "9c80d622-a10e-4818-b619-6f218aa6c120"
        } ],
        "description" : "Application access for the tenant presents a heightened security risk compared to interactive user access because applications are typically not subject to critical security protections, such as MFA policies. Reduce risk of unauthorized users installing malicious applications into the tenant by ensuring that only specific privileged users can register applications.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.5.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.10",
              "statement-ids" : [ "ac-6.10_smt" ]
            }, {
              "control-id" : "cm-5",
              "statement-ids" : [ "cm-5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a38c2e07-5a7f-4f4d-bb4a-abee8c7962a6",
        "title" : "Only administrators SHALL be allowed to consent to applications.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad52v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.001: Additional Cloud Credentials",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/001/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.2v1"
          } ],
          "description" : "In **Microsoft Entra admin center** select **Enterprise Applications**.",
          "uuid" : "6f49c199-4a00-413b-839f-deba0770e687"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.2v1"
          } ],
          "description" : "Under **Security** , select **Consent and permissions** . Then select **User Consent Settings**.",
          "uuid" : "aa6ca69e-4382-4f14-a26b-6b62f80ae856"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.2v1"
          } ],
          "description" : "Under **User consent for applications** , select **Do not allow user consent**.",
          "uuid" : "a7e559c2-b543-4c98-9e15-37a12935d61f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.2v1"
          } ],
          "description" : "Click **Save**.",
          "uuid" : "0ccd0929-9b11-48d0-8c1c-02d69da33f64"
        } ],
        "description" : "Limiting applications consent to only specific privileged users reduces risk of users giving insecure applications access to their data via [consent grant attacks](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/detect-and-remediate-illicit-consent-grants?view=o365-worldwide).",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.5.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.10",
              "statement-ids" : [ "ac-6.10_smt" ]
            }, {
              "control-id" : "cm-5",
              "statement-ids" : [ "cm-5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "b58e5978-37b1-43a4-8ff6-a55b789c7c8c",
        "title" : "An admin consent workflow SHALL be configured for applications.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad53v1"
        }, {
          "text" : "Restrict Application Registration for Non-Privileged Users",
          "rel" : "reference",
          "href" : "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/ActiveDirectory/users-can-register-applications.html"
        }, {
          "text" : "Enforce Administrators to Provide Consent for Apps Before Use",
          "rel" : "reference",
          "href" : "https://www.trendmicro.com/cloudoneconformity/knowledge-base/azure/ActiveDirectory/users-can-consent-to-apps-accessing-company-data-on-their-behalf.html"
        }, {
          "text" : "Configure the admin consent workflow",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/enterprise-apps/configure-admin-consent-workflow"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.001: Additional Cloud Credentials",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/001/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.3v1"
          } ],
          "description" : "In **Microsoft Entra admin center** create a new Microsoft Entra ID Group that contains admin users responsible for reviewing and adjudicating application consent requests. Group members will be notified when users request consent for new applications.",
          "uuid" : "3eee27d9-300f-4a58-8db4-6e0eeb62b6da"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.3v1"
          } ],
          "description" : "Then in **Microsoft Entra admin center** under **Applications** , select **Enterprise Applications**.",
          "uuid" : "19068343-512b-4062-bfd2-a25160d87413"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.3v1"
          } ],
          "description" : "Under **Security** , select **Consent and permissions** . Then select **Admin consent settings**.",
          "uuid" : "638b1758-c03b-453b-ade3-cb826073a03f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.3v1"
          } ],
          "description" : "Under **Admin consent requests** \\> **Users can request admin consent to apps they are unable to consent to** select **Yes**.",
          "uuid" : "1b75654b-c869-4d1f-8f84-728395db3281"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.3v1"
          } ],
          "description" : "Under **Who can review admin consent requests** , select **+ Add groups** and select the group responsible for reviewing and adjudicating app requests (created in step one above).",
          "uuid" : "45423cab-4083-4e8e-855e-e31d916691cd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.5.3v1"
          } ],
          "description" : "Click **Save**.",
          "uuid" : "fd850f4b-5916-4277-b98d-057326d1bf75"
        } ],
        "description" : "Configuring an admin consent workflow reduces the risk of the previous policy by setting up a process for users to securely request access to applications necessary for business purposes. Administrators have the opportunity to review the permissions requested by new applications and approve or deny access based on a risk assessment.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.5.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-4",
              "statement-ids" : [ "cm-4_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "10681185-5bd7-4c7e-88bd-6e25543471cc",
        "title" : "User passwords SHALL NOT expire.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad61v1"
        }, {
          "text" : "Password expiration requirements for users",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/admin/misc/password-policy-recommendations?view=o365-worldwide#password-expiration-requirements-for-users"
        }, {
          "text" : "Eliminate bad passwords using Microsoft Entra Password Protection",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/authentication/concept-password-ban-bad"
        }, {
          "text" : "NIST Special Publication 800-63B - Digital Identity Guidelines",
          "rel" : "reference",
          "href" : "https://pages.nist.gov/800-63-3/sp800-63b.html"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.6.1v1"
          } ],
          "description" : "[Configure the **Password expiration policy** to **Set passwords to never expire**](https://learn.microsoft.com/en-us/microsoft-365/admin/manage/set-password-expiration-policy?view=o365-worldwide#set-password-expiration-policy).",
          "uuid" : "3749649d-cb2c-42fa-a466-74f83489303c"
        } ],
        "description" : "The National Institute of Standards and Technology (NIST), OMB, and Microsoft have published guidance indicating mandated periodic password changes make user accounts less secure. For example, OMB-22-09 states, \"Password policies must not require use of special characters or regular rotation.\"",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.6.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ia-5.1",
              "statement-ids" : [ "ia-5.1_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a1585008-0175-453f-82f3-81d83c135ca2",
        "title" : "A minimum of two users and a maximum of eight users SHALL be provisioned with the Global Administrator role.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad71v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.1v1"
          } ],
          "description" : "When counting the number of users assigned to the Global Administrator role, count each user only once.",
          "uuid" : "b23fd35e-a8cc-4c7f-bf8f-3ab3ba6bc7e2"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.1v1"
          } ],
          "description" : "In **Microsoft Entra admin center** count the number of users assigned to the **Global Administrator** role. Count users that are assigned directly to the role and users assigned via group membership. If you have Microsoft Entra ID PIM, count both the **Eligible assignments** and **Active assignments** . If any of the groups assigned to Global Administrator are enrolled in PIM for Groups, also count the number of group members from the PIM for Groups portal **Eligible** assignments.",
          "uuid" : "221f01a3-548f-4fc0-9244-9f20f8c81642"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.1v1"
          } ],
          "description" : "Validate that there are a total of two to eight users assigned to the Global Administrator role.",
          "uuid" : "0442cc46-5f84-4d2d-9736-1cb51ab2be69"
        } ],
        "description" : "The Global Administrator role provides unfettered access to the tenant. Limiting the number of users with this level of access makes tenant compromise more challenging. Microsoft recommends fewer than five users in the Global Administrator role. However, additional user accounts, up to eight, may be necessary to support emergency access and some operational scenarios.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.5",
              "statement-ids" : [ "ac-6.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "efabf2bd-ed00-42ee-bb62-c3cb057e8c19",
        "title" : "Privileged users SHALL be provisioned with finer-grained roles instead of Global Administrator.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad72v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        }, {
          "text" : "T1651: Cloud Administration Command",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1651/"
        }, {
          "text" : "T1136: Create Account",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1136/"
        }, {
          "text" : "T1136.003: Cloud Account",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1136/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.2v1"
          } ],
          "description" : "This policy is based on the ratio below:\n\n`X = (Number of users assigned to the Global Administrator role) / (Number of users assigned to other highly privileged roles)`",
          "uuid" : "c88deaf2-dbae-43eb-a1e2-8e43b42a497d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.2v1"
          } ],
          "description" : "Follow the instructions for policy MS.AAD.7.1v1 above to get a count of users assigned to the Global Administrator role.",
          "uuid" : "0d02b51a-42fd-4310-8c4b-0dd4ceb4e36c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.2v1"
          } ],
          "description" : "Follow the instructions for policy MS.AAD.7.1v1 above but get a count of users assigned to the other highly privileged roles (not Global Administrator). If a user is assigned to both Global Administrator and other roles, only count that user for the Global Administrator assignment.",
          "uuid" : "34981278-8861-4bee-960e-0a60d76d8050"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.2v1"
          } ],
          "description" : "Divide the value from step 2 from the value from step 1 to calculate X. If X is less than or equal to 1 then the tenant is compliant with the policy.",
          "uuid" : "b9b888de-574b-4cac-9e76-3fa5d5e9d15c"
        } ],
        "description" : "Many privileged administrative users do not need unfettered access to the tenant to perform their duties. By assigning them to roles based on least privilege, the risks associated with having their accounts compromised are reduced.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-5",
              "statement-ids" : [ "ac-5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a1f7d441-c9c6-47ae-a49c-de37ac0be67c",
        "title" : "Privileged users SHALL be provisioned cloud-only accounts separate from an on-premises directory or other federated identity providers.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad73v1"
        }, {
          "text" : "T1556: Modify Authentication Process",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1556/"
        }, {
          "text" : "T1556.007: Hybrid Identity",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1556/007/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.3v1"
          } ],
          "description" : "Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.",
          "uuid" : "1326e348-f4dc-4d15-b4e8-26e3a687380e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.3v1"
          } ],
          "description" : "Create a list of all the users assigned to the **Global Administrator** role. Include users that are assigned directly to the role and users assigned via group membership. If you have Microsoft Entra ID PIM, include both the **Eligible assignments** and **Active assignments** . If any of the groups assigned to Global Administrator are enrolled in PIM for Groups, also include group members from the PIM for Groups portal **Eligible** assignments.",
          "uuid" : "787cd7d7-bfe1-490f-bb05-9433d624516a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.3v1"
          } ],
          "description" : "For each highly privileged user in the list, execute the Powershell code below but replace the `username@somedomain.com` with the principal name of the user who is specific to your environment. You can get the data value from the **Principal name** field displayed in the Microsoft Entra ID portal.\n\n    ```\n    Connect-MgGraph\n    Get-MgBetaUser -Filter \"userPrincipalName eq 'username@somedomain.com'\" | FL\n    ```",
          "uuid" : "2fd6f5b5-b483-46f3-beb5-6d9746613f5d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.3v1"
          } ],
          "description" : "Review the output field named **OnPremisesImmutableId**. If this field contains a data value, it means that the user is not cloud-only. If the user is not cloud-only, create a cloud-only account for that user, assign the user to their respective roles and then remove the account that is not cloud-only from Microsoft Entra ID.",
          "uuid" : "70079dea-751a-40e3-956d-38c6cbe80328"
        } ],
        "description" : "By provisioning cloud-only Microsoft Entra ID user accounts to privileged users, the risks associated with a compromise of on-premises federation infrastructure are reduced. It is more challenging for the adversary to pivot from the compromised environment to the cloud with privileged access.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.5",
              "statement-ids" : [ "ac-6.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "8ae83e9d-f3b1-4b4b-bd35-550c2e1c6e94",
        "title" : "Permanent active role assignments SHALL NOT be allowed for highly privileged roles.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad74v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.4v1"
          } ],
          "description" : "In **Microsoft Entra admin center** select **Roles and admins**. Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.",
          "uuid" : "9b2eb805-4e14-4739-9342-6d07dd6f8f13"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.4v1"
          } ],
          "description" : "Select the **Global administrator role**.",
          "uuid" : "6ea4dd83-dc53-43b0-9b15-da64423baa00"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.4v1"
          } ],
          "description" : "Under **Manage** , select **Assignments** and click the **Active assignments** tab.",
          "uuid" : "4f653214-0f09-45a1-b2c7-e382f7b060af"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.4v1"
          } ],
          "description" : "Verify there are no users or groups with a value of **Permanent** in the **End time** column. If there are any, recreate those assignments to have an expiration date using Microsoft Entra ID PIM or an alternative PAM system. If a group is identified and it is enrolled in PIM for Groups, see the exception cases below for details.\n\nException cases: - Emergency access accounts that require perpetual active assignment. - Service accounts that require perpetual active assignment. - If using PIM for Groups, a group that is enrolled in PIM is allowed to have a perpetual active assignment to a role because activation is handled by PIM for Groups.",
          "uuid" : "06d48221-7caa-49a3-99b7-0565c4c57639"
        } ],
        "description" : "Instead of giving users permanent assignments to privileged roles, provisioning access just in time lessens exposure if those accounts become compromised. In Microsoft Entra ID PIM or an alternative PAM system, just in time access can be provisioned by assigning users to roles as eligible instead of perpetually active.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2",
              "statement-ids" : [ "ac-2_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "b98999c6-0c53-4a31-884a-5715bd8c92ee",
        "title" : "Provisioning users to highly privileged roles SHALL NOT occur outside of a PAM system.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad75v1"
        }, {
          "text" : "T1651: Cloud Administration Command",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1651/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.5v1"
          } ],
          "description" : "Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.",
          "uuid" : "fdb9ef2d-80c8-42a2-806f-997dc9edbe91"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.5v1"
          } ],
          "description" : "In **Microsoft Entra admin center** select **Roles and admins**.",
          "uuid" : "09eba6a2-0753-4c93-af79-b750d0696cb3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.5v1"
          } ],
          "description" : "Select the **Global administrator role**.",
          "uuid" : "454ebb78-60c0-479c-97ee-c03284d4c25e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.5v1"
          } ],
          "description" : "Under **Manage** , select **Assignments** and click the **Active assignments** tab.",
          "uuid" : "cdafb80b-58f2-480d-9a32-9f4c9c09950e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.5v1"
          } ],
          "description" : "For each user or group listed, examine the value in the **Start time** column. If it contains a value of **-**, this indicates the respective user/group was assigned to that role outside of Microsoft Entra ID PIM. If the role was assigned outside of Microsoft Entra ID PIM, delete the assignment and recreate it using Microsoft Entra ID PIM.",
          "uuid" : "984667da-04fa-41a3-aa3e-9f1026984c06"
        } ],
        "description" : "Provisioning users to privileged roles within a PAM system enables enforcement of numerous privileged access policies and monitoring. If privileged users are assigned directly to roles in the M365 admin center or via PowerShell outside of the context of a PAM system, a significant set of critical security capabilities are bypassed.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.5v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2",
              "statement-ids" : [ "ac-2_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d123c805-6f80-4dc7-8dbf-eb1e61f96519",
        "title" : "Activation of the Global Administrator role SHALL require approval.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad76v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.6v1"
          } ],
          "description" : "In the **Microsoft Entra Portal** , under **Identity Governance** , select **Privileged Identity Management (PIM)** , and then under **Manage** , select **Microsoft Entra roles**.",
          "uuid" : "7753bdfc-96d6-4802-8d32-48199e67b33c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.6v1"
          } ],
          "description" : "Under **Manage** , select **Roles**.\n\n1. Select the **Global Administrator** role in the list.\n2. Click **Settings**.\n3. Click **Edit**.\n4. Select the **Require approval to activate** option.\n5. Click **Update**.",
          "uuid" : "67493564-a3d1-4dd0-82e3-8ab86141892a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.6v1"
          } ],
          "description" : "Review the list of groups that are actively assigned to the **Global Administrator** role. If any of the groups are enrolled in PIM for Groups, then also apply the same configurations under step 2 above to each PIM group's **Member** settings.",
          "uuid" : "010d5f7b-946c-4c58-82a9-de06f4464e97"
        } ],
        "description" : "Requiring approval for a user to activate Global Administrator, which provides unfettered access, makes it more challenging for an attacker to compromise the tenant with stolen credentials and it provides visibility of activities indicating a compromise is taking place.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.6v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.1",
              "statement-ids" : [ "ac-6.1_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "880603f9-4382-4f57-bbcf-c7909aac9d0b",
        "title" : "Eligible and Active highly privileged role assignments SHALL trigger an alert.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad77v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "In the **Microsoft Entra Portal** , under **Identity Governance** , select **Privileged Identity Management (PIM)** , and then under **Manage** , select **Microsoft Entra roles**.",
          "uuid" : "9935d364-a2ef-49f9-87ff-7bd866d60f3f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "Under **Manage** , select **Roles**. Perform the steps below for each highly privileged role. We reference the Global Administrator role as an example.",
          "uuid" : "337af1f2-9f7e-4bdd-9137-ce9f2ce918ad"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "Click the **Global Administrator** role.",
          "uuid" : "b91c8b77-cd26-4a81-985e-4edd3de0efeb"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "Click **Settings** and then click **Edit**.",
          "uuid" : "80d9dd51-3c22-4388-8510-82fc4f5c5658"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "Click the **Notification** tab.",
          "uuid" : "1534e6e3-ecf4-40f1-952f-6df2202820a2"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "Under **Send notifications when members are assigned as eligible to this role** , in the **Role assignment alert \\> Additional recipients** textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.",
          "uuid" : "f4ccaae5-e63c-4757-90ec-bb9d683250e7"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "Under **Send notifications when members are assigned as active to this role** , in the **Role assignment alert \\> Additional recipients** textbox, enter the email address of the security monitoring mailbox configured to receive privileged role assignment alerts.",
          "uuid" : "fa050543-b852-4aae-8a78-abbc93087628"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "Click **Update**.",
          "uuid" : "31225d26-d5c9-4044-8f9b-ac5d6ff723d5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.7v1"
          } ],
          "description" : "For each of the highly privileged roles, if they have any PIM groups actively assigned to them, then also apply the same configurations per the steps above to each PIM group's **Member** settings.",
          "uuid" : "96a87c42-8e3b-4ff6-b016-839a52de1640"
        } ],
        "description" : "Closely monitor assignment of the highest privileged roles for signs of compromise. Send assignment alerts to enable the security monitoring team to detect compromise attempts.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.7v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2.1",
              "statement-ids" : [ "ac-2.1_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "e34ef994-d645-4b3c-9900-b03926dfc5bb",
        "title" : "User activation of the Global Administrator role SHALL trigger an alert.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad78v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "In the **Microsoft Entra Portal** , under **Identity Governance** , select **Privileged Identity Management (PIM)** , and then under **Manage** , select **Microsoft Entra roles**.",
          "uuid" : "99b699a5-fdeb-4fa1-8323-928ae2951c77"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "Under **Manage** , select **Roles**.",
          "uuid" : "a8e07a9d-930e-46f4-a630-92b0ec622c9f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "Click the **Global Administrator** role.",
          "uuid" : "56c15b84-1dbd-4a56-b815-76103eacbb29"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "Click **Settings** and then click **Edit**.",
          "uuid" : "62a85b4e-c94a-423e-af1a-82d1397a80c6"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "Click the **Notification** tab.",
          "uuid" : "831e66d8-33f5-44b0-82de-4211d83c2595"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "Under **Send notifications when eligible members activate this role** , in the **Role activation alert \\> Additional recipients** textbox, enter the email address of the security monitoring mailbox configured to receive Global Administrator activation alerts.",
          "uuid" : "64497a7d-09eb-4df8-a311-e41ae383d031"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "Click **Update**.",
          "uuid" : "8277d04c-a4bd-4228-8abc-dba682510527"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.8v1"
          } ],
          "description" : "If the Global Administrator role has any PIM groups actively assigned to it, then also apply the same configurations per the steps above to each PIM group's **Member** settings.",
          "uuid" : "c3fd18e6-a3bc-40ad-9b0c-b780b4e74052"
        } ],
        "description" : "Closely monitor activation of the Global Administrator role for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.8v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.9",
              "statement-ids" : [ "ac-6.9_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "204e117e-d9dc-49c4-a6c1-69be8c6e142f",
        "title" : "User activation of other highly privileged roles SHOULD trigger an alert.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/aad.md#msaad79v1"
        }, {
          "text" : "Limit number of Global Administrators to less than 5",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/identity/role-based-access-control/best-practices#5-limit-the-number-of-global-administrators-to-less-than-5"
        }, {
          "text" : "Implement Privilege Access Management",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/azure/security/fundamentals/steps-secure-identity#implement-privilege-access-management"
        }, {
          "text" : "Assign Microsoft Entra roles in Privileged Identity Management",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-add-role-to-user"
        }, {
          "text" : "Privileged Identity Management (PIM) for Groups",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/concept-pim-for-groups"
        }, {
          "text" : "Approve or deny requests for Microsoft Entra roles in Privileged Identity Management",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-approval-workflow"
        }, {
          "text" : "Configure security alerts for Microsoft Entra roles in Privileged Identity Management",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/entra/id-governance/privileged-identity-management/pim-how-to-configure-security-alerts"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        }, {
          "text" : "T1136: Create Account",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1136/"
        }, {
          "text" : "T1136.003: Cloud Account",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1136/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.AAD.7.9v1"
          } ],
          "description" : "Follow the same instructions as MS.AAD.7.8v1 for each of the highly privileged roles (other than Global Administrator) but enter a security monitoring mailbox different from the one used to monitor Global Administrator activations.\n\n1. For each of the highly privileged roles, if they have any PIM groups actively assigned to them, then also apply the same configurations per step 1 to each PIM group's **Member** settings.",
          "uuid" : "f188429a-d60c-4f9e-a1bb-f577230812f4"
        } ],
        "description" : "Closely monitor activation of high-risk roles for signs of compromise. Send activation alerts to enable the security monitoring team to detect compromise attempts. In some environments, activating privileged roles can generate a significant number of alerts.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.AAD.7.9v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "aad"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.9",
              "statement-ids" : [ "ac-6.9_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "8cab3f34-93dd-4701-8777-aec9dd310d53",
        "title" : "The standard and strict preset security policies SHALL be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender11v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1566.003: Spearphishing via Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.1.1v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Under **Standard protection** , slide the toggle switch to the right so the text next to the toggle reads **Standard protection is on** . 6. Under **Strict protection** , slide the toggle switch to the right so the text next to the toggle reads **Strict protection is on**.\n\nNote: If the toggle slider in step 5 is grayed out, click on **Manage protection settings** instead and configure the policy settings according to [Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users).",
          "uuid" : "0446ba29-b28b-420a-8e62-2aa3f7c90044"
        } ],
        "description" : "Defender includes a large number of features and settings to protect users against threats. Using the preset security policies, administrators can help ensure all new and existing users automatically have secure defaults applied.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.1.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-6",
              "statement-ids" : [ "cm-6_smt.a" ]
            }, {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            }, {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "c80403dc-445c-4fbb-83a0-609ae9e75e30",
        "title" : "All users SHALL be added to Exchange Online Protection (EOP) in either the standard or strict preset security policy.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender12v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1566.003: Spearphishing via Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.1.2v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Select **Manage protection settings** under either **Standard protection** or **Strict protection** . 6. On the **Apply Exchange Online Protection** page, select **All recipients** . 7. (Optional) Under **Exclude these recipients** , add **Users** and **Groups** to be exempted from the preset policies. 8. Select **Next** on each page until the **Review and confirm your changes** page. 9. On the **Review and confirm your changes** page, select **Confirm**.",
          "uuid" : "f478932b-afa6-4249-96fd-2157ccd355e5"
        } ],
        "description" : "Important user protections are provided by EOP, including anti-spam, anti-malware, and anti-phishing protections. By using the preset policies, administrators can help ensure all new and existing users have secure defaults applied automatically.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.1.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-6",
              "statement-ids" : [ "cm-6_smt.a" ]
            }, {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            }, {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "2b1e8faf-c646-4200-8dc2-395d149a1a24",
        "title" : "All users SHALL be added to Defender for Office 365 protection in either the standard or strict preset security policy.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender13v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1566.003: Spearphishing via Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.1.3v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Under either **Standard protection** or **Strict protection** , select **Manage protection settings** . 6. Select **Next** until you reach the **Apply Defender for Office 365 protection** page. 7. On the **Apply Defender for Office 365 protection** page, select **All recipients** . 8. (Optional) Under **Exclude these recipients** , add **Users** and **Groups** to be exempted from the preset policies. 9. Select **Next** on each page until the **Review and confirm your changes** page. 10. On the **Review and confirm your changes** page, select **Confirm**.",
          "uuid" : "eb405fb2-52d9-43d4-80a6-d18f0b1af65c"
        } ],
        "description" : "Important user protections are provided by Defender for Office 365 protection, including safe attachments and safe links. By using the preset policies, administrators can help ensure all new and existing users have secure defaults applied automatically.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.1.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-6",
              "statement-ids" : [ "cm-6_smt.a" ]
            }, {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            }, {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "4ce25c0d-7527-4069-810f-14fcf81911f1",
        "title" : "Sensitive accounts SHALL be added to Exchange Online Protection in the strict preset security policy.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender14v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.1.4v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Under **Strict protection** , select **Manage protection settings** . 6. On the **Apply Exchange Online Protection** page, select **Specific recipients** . 7. Add all sensitive accounts via the **User** and **Group** boxes using the names of mailboxes, users, contacts, M365 groups, and distribution groups. 8. Select **Next** on each page until the **Review and confirm your changes** page. 9. On the **Review and confirm your changes** page, select **Confirm**.",
          "uuid" : "de48bf20-3168-47fb-a2e1-233055a0a8e8"
        } ],
        "description" : "Unauthorized access to a sensitive account may result in greater harm than a standard user account. Adding sensitive accounts to the strict preset security policy, with its increased protections, better mitigates their elevated risk to email threats.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.1.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-6",
              "statement-ids" : [ "cm-6_smt.a" ]
            }, {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            }, {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a9033ab8-145f-44b5-a27e-461e2750bb25",
        "title" : "Sensitive accounts SHALL be added to Defender for Office 365 protection in the strict preset security policy.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender15v1"
        }, {
          "text" : "Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users"
        }, {
          "text" : "Configure anti-phishing policies in EOP \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-phishing-policies-eop-configure?view=o365-worldwide"
        }, {
          "text" : "Configure anti-malware policies in EOP \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-malware-policies-configure?view=o365-worldwide"
        }, {
          "text" : "Configure anti-spam policies in EOP \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-spam-policies-configure?view=o365-worldwide"
        }, {
          "text" : "Configure anti-phishing policies in Defender for Office 365 \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-phishing-policies-mdo-configure?view=o365-worldwide"
        }, {
          "text" : "Set up Safe Attachments policies in Microsoft Defender for Office 365 \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/safe-attachments-policies-configure?view=o365-worldwide"
        }, {
          "text" : "Set up Safe Links policies in Microsoft Defender for Office 365 \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/safe-links-policies-configure?view=o365-worldwide"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.1.5v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Under **Strict protection** , select **Manage protection settings** . 6. Select **Next** until you reach the **Apply Defender for Office 365 protection** page. 7. On the **Apply Defender for Office 365 protection** page, select **Specific recipients** or **Previously selected recipients** if sensitive accounts were already set on the EOP page. 8. If adding sensitive accounts separately via **Specific recipients** , add all sensitive accounts via the **User** and **Group** boxes using the names of mailboxes, users, contacts, M365 groups, and distribution groups. 9. (Optional) Under **Exclude these recipients** , add **Users** and **Groups** to be exempted from the preset policies. 10. Select **Next** on each page until the **Review and confirm your changes** page. 11. On the **Review and confirm your changes** page, select **Confirm**.",
          "uuid" : "a5e4a9f8-48e6-4ec2-be81-5616d2904b80"
        } ],
        "description" : "Unauthorized access to a sensitive account may result in greater harm than to a standard user account. Adding sensitive accounts to the strict preset security policy, with its increased protections, better mitigates their elevated risk.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.1.5v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-6",
              "statement-ids" : [ "cm-6_smt.a" ]
            }, {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            }, {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d4259041-db97-4ce4-9f71-abb9a1307913",
        "title" : "User impersonation protection SHOULD be enabled for sensitive accounts in both the standard and strict preset policies.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender21v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.2.1v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Under either **Standard protection** or **Strict protection** , select **Manage protection settings** . 6. Select **Next** until you reach the **Impersonation Protection** page, then select **Next** once more. 7. On the **Protected custom users** page, add a name and valid email address for each sensitive account and click **Add** after each. 8. Select **Next** until you reach the **Trusted senders and domains** page. 9. (Optional) Add specific email addresses here to not flag as impersonation when sending messages and prevent false positives. Click **Add** after each. 10. Select **Next** on each page until the **Review and confirm your changes** page. 11. On the **Review and confirm your changes** page, select **Confirm**.",
          "uuid" : "9a7ffeea-39a3-49ba-8c44-dbadf7df832a"
        } ],
        "description" : "User impersonation, especially of users with access to sensitive or high-value information and resources, has the potential to result in serious harm. Impersonation protection mitigates this risk. By configuring impersonation protection in both preset policies, administrators can help protect email recipients from impersonated emails, regardless of whether they are added to the standard or strict policy.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.2.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a6cfdfc9-e704-4482-b2fb-2a32dae45d3c",
        "title" : "Domain impersonation protection SHOULD be enabled for domains owned by the agency in both the standard and strict preset policies.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender22v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.2.2v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Under either **Standard protection** or **Strict protection** , select **Manage protection settings** . 6. Select **Next** until you reach the **Impersonation Protection** page, then select **Next** once more. 7. On the **Protected custom domains** page, add each agency domain and click **Add** after each. 8. Select **Next** until you reach the **Trusted senders and domains** page. 9. (Optional) Add specific domains here to not flag as impersonation when sending messages and prevent false positives. Click **Add** after each. 10. Select **Next** on each page until the **Review and confirm your changes** page. 11. On the **Review and confirm your changes** page, select **Confirm**.",
          "uuid" : "654308ce-62c8-428f-922d-726f0e6f45ce"
        } ],
        "description" : "Configuring domain impersonation protection for all agency domains reduces the risk of a user being deceived by a look-alike domain. By configuring impersonation protection in both preset policies, administrators can help protect email recipients from impersonated emails, regardless of whether they are added to the standard or strict policy.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.2.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a1994138-31e7-4e36-9ee9-600a0c5d00bf",
        "title" : "Domain impersonation protection SHOULD be added for important partners in both the standard and strict preset policies.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender23v1"
        }, {
          "text" : "Impersonation settings in anti-phishing policies in Microsoft Defender for Office 365 \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/anti-phishing-policies-about?view=o365-worldwide#impersonation-settings-in-anti-phishing-policies-in-microsoft-defender-for-office-365"
        }, {
          "text" : "Use the Microsoft 365 Defender portal to assign Standard and Strict preset security policies to users \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/preset-security-policies?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-assign-standard-and-strict-preset-security-policies-to-users"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.2.3v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender** . 2. In the left-hand menu, go to **Email \\& Collaboration** \\> **Policies \\& Rules** . 3. Select **Threat Policies** . 4. From the **Templated policies** section, select **Preset Security Policies** . 5. Under either **Standard protection** or **Strict protection** , select **Manage protection settings** . 6. Select **Next** until you reach the **Impersonation Protection** page, then select **Next** once more. 7. On the **Protected custom domains** page, add each partner domain and click **Add** after each. 8. Select **Next** on each page until the **Review and confirm your changes** page. 9. On the **Review and confirm your changes** page, select **Confirm**.",
          "uuid" : "449e92e0-c2c5-4a5e-b047-6d56836fcbb6"
        } ],
        "description" : "Configuring domain impersonation protection for domains owned by important partners reduces the risk of a user being deceived by a look-alike domain. By configuring impersonation protection in both preset policies, administrators can help protect email recipients from impersonated emails, regardless of whether they are added to the standard or strict policy.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.2.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "653b5041-65b0-4d19-ad92-06b182885293",
        "title" : "Safe attachments SHOULD be enabled for SharePoint, OneDrive, and Microsoft Teams.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender31v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1204.001: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.001: Malicious Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/001/"
        }, {
          "text" : "T1204.002: Malicious File",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.3.1v1"
          } ],
          "description" : "To enable Safe Attachments for SharePoint, OneDrive, and Microsoft Teams, follow the instructions listed at [Turn on Safe Attachments for SharePoint, OneDrive, and Microsoft Teams \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/safe-attachments-for-spo-odfb-teams-configure?view=o365-worldwide).",
          "uuid" : "75f2e6c8-7011-46d8-bc35-3be70640c250"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.3.1v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender**.",
          "uuid" : "97c71c6a-f914-42b4-99bf-1d4fd5ba4836"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.3.1v1"
          } ],
          "description" : "Under **Email \\& collaboration** , select **Policies \\& rules**.",
          "uuid" : "2d481c54-62ae-46b6-97fa-112072ccd4f8"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.3.1v1"
          } ],
          "description" : "Select **Threat policies**.",
          "uuid" : "2ff3a7cc-01b5-4a66-829f-895837a31c5e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.3.1v1"
          } ],
          "description" : "Under **Policies** , select **Safe Attachments**.",
          "uuid" : "3c35a27c-27b0-4b62-89ef-0df6e0a6acb5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.3.1v1"
          } ],
          "description" : "Select **Global settings**.",
          "uuid" : "47d9264b-fcc6-4b55-970c-0e206dbce9e3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.3.1v1"
          } ],
          "description" : "Toggle the **Turn on Defender for Office 365 for SharePoint, OneDrive, and Microsoft Teams** slider to **On**.",
          "uuid" : "e4b09524-9876-40e7-af7e-1c85812b8515"
        } ],
        "description" : "Clicking malicious links makes users vulnerable to attacks, and this danger is not limited to links in emails. Other Microsoft products, such as Microsoft Teams, can be used to present users with malicious links. As such, it is important to protect users on these other Microsoft products as well.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.3.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "1923d1be-3ec6-44b4-ac54-59fec0ca784f",
        "title" : "A custom policy SHALL be configured to protect PII and sensitive information, as defined by the agency, blocking at a minimum: credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN).",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender41v2"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Sign in to the **Microsoft Purview portal**.",
          "uuid" : "d6ad7056-7c5d-4dcb-9da2-55c1f3eb23cd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Under the **Solutions** section on the left-hand menu, select **Data loss prevention**.",
          "uuid" : "20b562b7-080f-4d8f-83be-dcafe0688a0c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Select **Policies** from the top of the page.",
          "uuid" : "5517a72a-90e7-4c97-a0c7-6367db2a3ede"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Select **Create policy**.",
          "uuid" : "748071c2-0b57-44b9-9a60-b18d65405d15"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "From the **Categories** list, select **Custom**.",
          "uuid" : "9d1b017f-2138-43a7-a359-b6b2d9f2e5b4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "From the **Regulations** list, select **Custom policy** and then click **Next**.",
          "uuid" : "9a82f07b-ccbf-4460-b956-41578f5fff1d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Edit the name and description of the policy if desired, then click **Next**.",
          "uuid" : "0c692be0-9238-47ee-b3aa-d4b8cfbc440b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Under **Assign admin units** , ensure **Admin units** is set to **Full directory** by default, then click **Next**.\n\n1. Under **Choose where to apply the policy** , set **Status** to **On** for at least the Exchange email, OneDrive accounts, SharePoint sites, Teams chat and channel messages, and Devices locations, then click **Next**.",
          "uuid" : "4e7ddf92-ce5a-41e3-b839-595f8f7bae39"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Under **Define policy settings** , select **Create or customize advanced DLP rules** , and then click **Next**.",
          "uuid" : "739cb763-6a03-4e86-a18f-1a10585b1ad9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Click **Create rule**. Assign the rule an appropriate name and description.",
          "uuid" : "8c150e92-f9cd-423f-8cee-9615d821e97f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Click **Add condition** , then **Content contains**.",
          "uuid" : "0491d0a2-9c4a-4a71-a33c-a35bc6314843"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Click **Add** , then **Sensitive info types**.",
          "uuid" : "3b43b7b1-f633-4392-affe-8bd617d44acc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Add information types that protect information sensitive to the agency. At a minimum, the agency should protect:\n\n    - Credit card numbers\n    - U.S. Individual Taxpayer Identification Numbers (ITIN)\n    - U.S. Social Security Numbers (SSN)\n    - All agency-defined PII and sensitive information",
          "uuid" : "67a007d8-d709-4226-b5ec-91532e0a8910"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Click **Add**.",
          "uuid" : "f0f0b5d4-b0d4-4e4d-bf1c-24077e5c7fba"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Under **Actions** , click **Add an action**.",
          "uuid" : "1754c145-a7c8-4795-ad42-f43b0a2ff6a7"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Check **Restrict Access or encrypt the content in Microsoft 365 locations**.",
          "uuid" : "de2cd71b-0f7e-4f05-857e-05beffe19c48"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Under this action, select **Block Everyone**.",
          "uuid" : "06533b8c-04c8-4b51-9304-ae2d6e2e4c02"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Under **User notifications** , turn on **Use notifications to inform your users and help educate them on the proper use of sensitive info**.",
          "uuid" : "b1aabe24-ae20-4079-81c8-d1618642e356"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Under **Microsoft 365 services** if using a GCC environment or under **Microsoft 365 files and Microsoft Fabric items** if using a Commercial environment, a section that appears after user notifications are turned on, check the box next to **Notify users in Office 365 service with a policy tip or email notifications**.",
          "uuid" : "79b8764b-6e6e-41e0-be95-a795d86e14d9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Click **Save** , then **Next**.",
          "uuid" : "d10d9e73-4d67-4dde-961e-3aa66a9edd68"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Select **Turn the policy on immediately** , then click **Next**.",
          "uuid" : "49c911ef-809b-4a25-b42b-c49fc0e50cb2"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.1v2"
          } ],
          "description" : "Click **Submit**.",
          "uuid" : "605de601-09a5-473f-a8f7-6712e2bd5a20"
        } ],
        "description" : "Users may inadvertently share sensitive information with others who should not have access to it. DLP policies provide a way for agencies to detect and prevent unauthorized disclosures.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.4.1v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "9f71b9e9-9ee7-490c-b474-227fb72b349e",
        "title" : "The custom policy SHOULD be applied to Exchange, OneDrive, SharePoint, Teams chat, and Devices.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender42v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.2v1"
          } ],
          "description" : "See [MS.DEFENDER.4.1v2 Instructions](#msdefender41v2-instructions) step 8 for details on enforcing DLP policy in specific M365 service locations.",
          "uuid" : "6fc02124-7d95-4ed1-b63b-035e41bb000f"
        } ],
        "description" : "Unauthorized disclosures may happen through M365 services or endpoint devices. DLP policies should cover all affected locations to be effective.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.4.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "01f6ff98-2b3d-4f1c-af07-b4a18b42fb81",
        "title" : "The action for the custom policy SHOULD be set to block sharing sensitive information with everyone.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender43v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.3v1"
          } ],
          "description" : "See [MS.DEFENDER.4.1v2 Instructions](#msdefender41v2-instructions) steps 15-17 for details on configuring DLP policy to block sharing sensitive information with everyone.",
          "uuid" : "bbc09ce6-75df-44b5-8ec0-57b8a7082435"
        } ],
        "description" : "Access to sensitive information should be prohibited unless explicitly allowed. Specific exemptions can be made based on agency policies and valid business justifications.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.4.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "69765221-49eb-4736-afdb-f4223b2c6f83",
        "title" : "Notifications to inform users and help educate them on the proper use of sensitive information SHOULD be enabled in the custom policy.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender44v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.4v1"
          } ],
          "description" : "See [MS.DEFENDER.4.1v2 Instructions](#msdefender41v2-instructions) steps 18-19 for details on configuring DLP policy to notify users when accessing sensitive information.",
          "uuid" : "63edab4d-e491-40de-a49f-8336f8f078ad"
        } ],
        "description" : "Some users may not be aware of agency policies on proper use of sensitive information. Enabling notifications provides positive feedback to users when accessing sensitive information.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.4.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "at-2",
              "statement-ids" : [ "at-2_smt.b" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "6c5d1985-d401-42d0-8579-989c10642d78",
        "title" : "A list of apps that are restricted from accessing files protected by DLP policy SHOULD be defined.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender45v1"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1485: Data Destruction",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1485/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Sign in to the **Microsoft Purview portal**.",
          "uuid" : "39950855-b29a-4911-ba73-1c5aae9c04b9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Go to **Settings** , under **Solution Settings** select **Data loss prevention**.",
          "uuid" : "ee14746c-12db-49e4-a250-1890cf567c93"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Go to **Endpoint DLP Settings**.",
          "uuid" : "802385c4-b53d-414f-9646-88eb2b3e45a4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Go to **Restricted apps and app groups**.",
          "uuid" : "6c30467b-9ccf-4f0c-a7aa-27da376f5e21"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Click **Add or edit Restricted Apps**.",
          "uuid" : "b5c2fed2-8aca-4e6f-acc3-db766e974888"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Enter an app and executable name to disallow said app from accessing protected files, and log the incident.",
          "uuid" : "47e63552-445c-46fc-90a7-cbe543e7c4f0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Return and click **Unallowed Bluetooth apps**.",
          "uuid" : "d166fb27-f1a5-4198-97c2-c7f09880f040"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Click **Add or edit unallowed Bluetooth apps**.",
          "uuid" : "a823c530-0ff4-4a74-8080-7b6a2539f593"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.5v1"
          } ],
          "description" : "Enter an app and executable name to disallow said app from accessing protected files, and log the incident.",
          "uuid" : "c7a5a1a4-dd9a-40f0-896d-159aef729ee5"
        } ],
        "description" : "Some apps may inappropriately share accessed files or not conform to agency policies for access to sensitive information. Defining a list of those apps makes it possible to use DLP policies to restrict those apps' access to sensitive information on endpoints using Defender.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.4.5v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "3787ad6e-ede5-49f2-a253-9634afc7750c",
        "title" : "The custom policy SHOULD include an action to block access to sensitive",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender46v1"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1485: Data Destruction",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1485/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        }, {
          "text" : "T1486: Data Encrypted for Impact",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1486/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "If restricted app and unwanted Bluetooth app restrictions are desired, associated devices must be onboarded with Defender for Endpoint before the instructions below can be completed.",
          "uuid" : "cad00350-7bf6-4386-83fc-d18343e0b01e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Sign in to the **Microsoft Purview portal**.",
          "uuid" : "28998466-b958-4ac9-860d-a3bc9d6cbaed"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Under **Solutions** , select **Data loss prevention**.",
          "uuid" : "5f6a0f7c-d82f-42c2-9f4c-db879236eed6"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Select **Policies** from the top of the page.",
          "uuid" : "011eefcf-e202-4057-83da-edd443deb6ed"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Find the custom DLP policy configured under [MS.DEFENDER.4.1v2 Instructions](#msdefender41v2-instructions) in the list and click the Policy name to select.",
          "uuid" : "8bc4f521-4a6c-4edb-bb0c-bf59e8cdc460"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Select **Edit Policy**.",
          "uuid" : "e1996b87-5d24-4af2-ba0f-e03e01906af3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Click **Next** on each page in the policy wizard until you reach the Advanced DLP rules page.",
          "uuid" : "198a6811-d9d1-4533-b602-819b4b6aa34c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Select the relevant rule and click the pencil icon to edit it.",
          "uuid" : "62fbd175-9cd2-42e1-bfb1-94c0bdd590f0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Under **Actions** , click **Add an action**.",
          "uuid" : "4a9d5bc0-d4bb-4a61-bacc-4602590aaa2c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Choose **Audit or restrict activities on device**",
          "uuid" : "53eed93e-e6ab-4ced-b9f2-07b1e5b89b19"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Under **File activities for all apps** , select **Apply restrictions to specific activity**.",
          "uuid" : "07d41dcc-3cab-4b45-91bc-98ca790d1d8d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Check the box next to **Copy or move using unallowed Bluetooth app** and set its action to **Block**.",
          "uuid" : "d248544d-db8d-439e-a7e6-41ad6b5e981e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Under **Restricted app activities** , check the **Access by restricted apps** box and set the action drop-down to **Block**.",
          "uuid" : "18b14c58-f215-49e7-b402-80df42cfb5fe"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Click **Save** to save the changes.",
          "uuid" : "10a5dd74-1749-41b5-8d39-fbbf1b31c844"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Click **Next** on each page until reaching the **Review your policy and create it** page.",
          "uuid" : "262b25d4-cd76-47b1-a90a-6de2ccb50df7"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.4.6v1"
          } ],
          "description" : "Review the policy and click **Submit** to complete the policy changes.",
          "uuid" : "c4342f7c-984f-42a1-ac15-df00f902ffb5"
        } ],
        "description" : "Some apps may inappropriately share accessed files or not conform to agency policies for access to sensitive information. Defining a DLP policy with an action to block access from restricted apps and unwanted Bluetooth applications prevents unauthorized disclosure by those programs.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.4.6v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-19",
              "statement-ids" : [ "ac-19_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "73ad8a55-10fe-4fa1-a62a-349c167cde90",
        "title" : "At a minimum, the alerts required by the CISA M365 Secure Configuration Baseline for Exchange Online SHALL be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender51v1"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.006: Indicator Blocking",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/006/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.1v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender**.",
          "uuid" : "e8662c68-84a0-48f0-a3ca-909b418a5a14"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.1v1"
          } ],
          "description" : "Under **Email \\& collaboration** , select **Policies \\& rules**.",
          "uuid" : "929f0e09-f929-4800-b857-4522de22f993"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.1v1"
          } ],
          "description" : "Select **Alert Policy**.",
          "uuid" : "3992693e-34ac-4960-a1b5-78ae26054d87"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.1v1"
          } ],
          "description" : "Select the checkbox next to each alert to enable as determined by the agency and at a minimum those referenced in the [*CISA M365 Secure Configuration Baseline for Exchange Online*](./exo.md#msexo161v1) which are:\n\na. **Suspicious email sending patterns detected.**\n\nb. **Suspicious connector activity.**\n\nc. **Suspicious Email Forwarding Activity.**\n\nd. **Messages have been delayed.**\n\ne. **Tenant restricted from sending unprovisioned email.**\n\nf. **Tenant restricted from sending email.**\n\ng. **A potentially malicious URL click was detected.**",
          "uuid" : "fd032879-bc73-4829-beec-9599753fbbe1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.1v1"
          } ],
          "description" : "Click the pencil icon from the top menu.",
          "uuid" : "04187f9a-0f26-4866-872e-52ffd7010782"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.1v1"
          } ],
          "description" : "Select the **Enable selected policies** action from the **Bulk actions** menu.",
          "uuid" : "57c679f1-8fba-46ac-ae37-0e24e7d74c6e"
        } ],
        "description" : "Potentially malicious or service-impacting events may go undetected without a means of detecting these events. Setting up a mechanism to alert administrators to the list of events linked above draws attention to them to minimize any impact to users and the agency.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.5.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-4.5",
              "statement-ids" : [ "si-4.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a9bf9393-7786-420e-9cfd-7ac80a08482b",
        "title" : "The alerts SHOULD be sent to a monitored address or incorporated into a Security Information and Event Management (SIEM).",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender52v1"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.006: Indicator Blocking",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/006/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "For each enabled alert, to add one or more email recipients:",
          "uuid" : "21baf856-d857-484f-907e-21a9dba08007"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender**.",
          "uuid" : "c25baf89-4a13-4d61-a6d3-00801b2d20bc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Under **Email \\& collaboration** , select **Policies \\& rules**.",
          "uuid" : "f8e20b32-60c8-4e25-aa8c-068e3f60ed45"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Select **Alert Policy**.",
          "uuid" : "fc34bf87-998b-4f6e-9819-30340063d402"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Click the alert policy to modify.",
          "uuid" : "b251375f-0762-405c-8fca-c822f655d905"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Click the pencil icon next to **Set your recipients**.",
          "uuid" : "14d2a896-0987-4c35-9947-d8ef41eaf908"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Check the **Opt-In for email notifications** box.",
          "uuid" : "6b62747c-0761-4037-ad98-af9ee7d20382"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Add one or more email addresses to the **Email recipients** text box.",
          "uuid" : "90f074f8-8263-49bc-960d-3e20160af092"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "Click **Next**.",
          "uuid" : "612d449e-8343-49ac-9962-51f43ece8540"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.5.2v1"
          } ],
          "description" : "On the **Review** page, click **Submit** to save the notification settings.",
          "uuid" : "7adcd1f2-6c72-48f8-bdcb-4833b341a50b"
        } ],
        "description" : "Suspicious or malicious events, if not resolved promptly, may have a greater impact to users and the agency. Sending alerts to a monitored email address or SIEM system helps ensure events are acted upon in a timely manner to limit overall impact.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.5.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-4.5",
              "statement-ids" : [ "si-4.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d2808a80-031f-4a6c-b0f0-b78b621852ef",
        "title" : "Unified Audit logging SHALL be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender61v1"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.008: Disable or Modify Cloud Logs",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/008/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.6.1v1"
          } ],
          "description" : "To enable auditing via the **Microsoft Purview portal**:",
          "uuid" : "5453f976-e34e-49fc-b2f2-2d98a817d13c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.6.1v1"
          } ],
          "description" : "Sign in to the **Microsoft Purview portal**.",
          "uuid" : "e3e3347a-0379-4b9b-8a07-daadbcdff837"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.6.1v1"
          } ],
          "description" : "Under **Solutions** , select **Audit**.",
          "uuid" : "23c2052d-212e-49d7-b20c-48a412645ef8"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.6.1v1"
          } ],
          "description" : "If auditing is not enabled, a banner is displayed to notify the administrator to start recording user and admin activity.",
          "uuid" : "820b8b47-d5e7-46bf-9e61-c524049da843"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.6.1v1"
          } ],
          "description" : "Click the **Start recording user and admin activity**.",
          "uuid" : "cbc2dd87-ef53-40ff-be2c-9e50f4696407"
        } ],
        "description" : "Responding to incidents without detailed information about activities that took place slows response actions. Enabling Unified Audit logging helps ensure agencies have visibility into user actions. Furthermore, enabling the Unified Audit log is required for government agencies by OMB M-21-31.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.6.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "au-12",
              "statement-ids" : [ "au-12_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "b3e1ab46-d211-453c-a448-4f92e322e2db",
        "title" : "Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/defender.md#msdefender63v1"
        }, {
          "text" : "Export, configure, and view audit log records \\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/purview/audit-log-export-records"
        }, {
          "text" : "Untitled Goose Tool Fact Sheet \\| CISA.",
          "rel" : "reference",
          "href" : "https://www.cisa.gov/resources-tools/resources/untitled-goose-tool-fact-sheet"
        }, {
          "text" : "Manage audit log retention policies \\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies?tabs=microsoft-purview-portal#before-you-create-an-audit-log-retention-policy"
        }, {
          "text" : "T1070: Indicator Removal",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1070/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.DEFENDER.6.3v1"
          } ],
          "description" : "To create one or more custom audit retention policies, if the default retention policy is not sufficient for agency needs, follow [Create an audit log retention policy](https://learn.microsoft.com/en-us/purview/audit-log-retention-policies?view=o365-worldwide#create-an-audit-log-retention-policy) instructions. Ensure the duration selected in the retention policies is at least one year, in accordance with OMB M-21-31.\n\nAs noted in the [License Requirements](https://github.com/cisagov/ScubaGear/baselines/defender.md#license-requirements-1) section above, the creation of a custom audit log retention policy and its retention in the M365 environment requires E5/G5 licenses or E3/G3 licenses with add-on compliance licenses. No additional license is required to view and export logs. To view and export audit logs follow [Export, configure, and view audit log records \\| Microsoft Learn](https://learn.microsoft.com/en-us/purview/audit-log-export-records) and/or [Untitled Goose Tool Fact Sheet \\| CISA.](https://www.cisa.gov/resources-tools/resources/untitled-goose-tool-fact-sheet)\n\n**`TLP:CLEAR`**",
          "uuid" : "ae5e66ea-2d60-42a2-8578-9b50bfd8f98a"
        } ],
        "description" : "Audit logs may no longer be available when needed if they are not retained for a sufficient time. Increased log retention time gives an agency the necessary visibility to investigate incidents that occurred some time ago.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.DEFENDER.6.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "defender"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "au-11",
              "statement-ids" : [ "au-11_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "713b29c3-3463-4a3a-8a29-8d50764563bb",
        "title" : "Automatic forwarding to external domains SHALL be disabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo11v2"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.1.1v2"
          } ],
          "description" : "To disallow automatic forwarding to external domains:",
          "uuid" : "b04026e3-3881-42e3-b3e4-779ff089051d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.1.1v2"
          } ],
          "description" : "Sign in to the **Exchange admin center**.",
          "uuid" : "e305c8dd-653b-4c95-99d2-ab415e7f9f5f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.1.1v2"
          } ],
          "description" : "Select **Mail flow** , then **Remote domains**.",
          "uuid" : "53520964-41c8-452f-96e3-30b46e08e733"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.1.1v2"
          } ],
          "description" : "Select **Default**.",
          "uuid" : "658ab2e4-576a-4167-b753-bea2939ee399"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.1.1v2"
          } ],
          "description" : "Under **Email reply types** , select **Edit reply types**.",
          "uuid" : "438270ba-4af9-484c-910c-0718f93ef946"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.1.1v2"
          } ],
          "description" : "Clear the checkbox next to **Allow automatic forwarding** , then click **Save**.",
          "uuid" : "f7f8530b-06fa-4edb-96ae-83319e92d366"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.1.1v2"
          } ],
          "description" : "Return to **Remote domains** and review each additional remote domain in the list, ensuring that automatic forwarding is only allowed for approved domains.",
          "uuid" : "3f8b8b87-0a3a-4283-8633-4a5546410cb3"
        } ],
        "description" : "Adversaries can use automatic forwarding to gain persistent access to a victim's email. Disabling forwarding to external domains prevents this technique when the adversary is external to the organization but does not impede legitimate internal forwarding.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.1.1v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-4",
              "statement-ids" : [ "ac-4_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "7a703e40-a05b-43b1-8692-c7ba991f030d",
        "title" : "An SPF policy SHALL be published for each domain that fails all non-approved senders.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo22v2"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.2.2v2"
          } ],
          "description" : "First, identify any approved senders specific to your agency, e.g., any on-premises mail servers. SPF allows you to indicate approved senders by IP address or CIDR range. However, note that SPF allows you to [include](https://www.rfc-editor.org/rfc/rfc7208#section-5.2) the IP addresses indicated by a separate SPF policy, referred to by domain name. See [External DNS records required for SPF](https://learn.microsoft.com/en-us/microsoft-365/enterprise/external-domain-name-system-records?view=o365-worldwide#external-dns-records-required-for-spf) for inclusions required for M365 to send email on behalf of your domain.\n\nSPF is not configured through the Exchange admin center, but rather via DNS records hosted by the agency's domain. Thus, the exact steps needed to set up SPF varies from agency to agency. See [Add or edit an SPF TXT record to help prevent email spam (Outlook, Exchange Online) \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/admin/get-help-with-domains/create-dns-records-at-any-dns-hosting-provider?view=o365-worldwide#add-or-edit-an-spf-txt-record-to-help-prevent-email-spam-outlook-exchange-online) for more details.\n\nTo test your SPF configuration, consider using a web-based tool, such as those listed under [How can I validate SPF records for my domain? \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/admin/setup/domains-faq?view=o365-worldwide#how-can-i-validate-spf-records-for-my-domain). Additionally, SPF records can be requested using the PowerShell tool `Resolve-DnsName`. For example:\n\n`Resolve-DnsName example.onmicrosoft.com txt`\n\nIf SPF is configured, you will see a response resembling `v=spf1 include:spf.protection.outlook.com -all` returned; though by necessity, the contents of the SPF policy may vary by agency. In this example, the SPF policy indicates the IP addresses listed by the policy for \"spf.protection.outlook.com\" are the only approved senders for \"example.onmicrosoft.com.\" These IPs can be determined via an additional SPF lookup, this time for \"spf.protection.outlook.com.\" Ensure the IP addresses listed as approved senders for your domains are correct. Additionally, ensure that each policy either ends in `-all` or [redirects](https://www.rfc-editor.org/rfc/rfc7208#section-6.1) to one that does; this directive indicates that all IPs that don't match the policy should fail. See [SPF TXT record syntax for Microsoft 365 \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-anti-spoofing?view=o365-worldwide#spf-txt-record-syntax-for-microsoft-365) for a more in-depth discussion of SPF record syntax.",
          "uuid" : "ee83b340-7ca7-4881-9cf2-76e0123f6509"
        } ],
        "description" : "An adversary may modify the `FROM` field of an email such that it appears to be a legitimate email sent by an agency, facilitating phishing attacks. Publishing an SPF policy for each agency domain mitigates forged `FROM` fields by providing a means for recipients to detect emails spoofed in this way. SPF is required for FCEB departments and agencies by Binding Operational Directive (BOD) 18-01, \"Enhance Email and Web Security\".",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.2.2v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2",
              "statement-ids" : [ "ac-2_smt.d" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "dc0e16e1-b52f-4e23-84a0-d840356e596c",
        "title" : "DKIM SHOULD be enabled for all domains.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo31v1"
        }, {
          "text" : "T1598: Phishing for Information",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1598/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.3.1v1"
          } ],
          "description" : "To enable DKIM, follow the instructions listed on [Steps to Create, enable and disable DKIM from Microsoft 365 Defender portal \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-dkim-configure?view=o365-worldwide#steps-to-create-enable-and-disable-dkim-from-microsoft-365-defender-portal).",
          "uuid" : "9e60a6f3-fe67-40de-9989-82fd242a09c3"
        } ],
        "description" : "An adversary may modify the `FROM` field of an email such that it appears to be a legitimate email sent by an agency, facilitating phishing attacks. Enabling DKIM is another means for recipients to detect spoofed emails and verify the integrity of email content.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.3.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-8",
              "statement-ids" : [ "sc-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "2ca4d717-1cdb-4613-95a8-4c0700e26431",
        "title" : "A DMARC policy SHALL be published for every second-level domain.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo41v1"
        }, {
          "text" : "T1598: Phishing for Information",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1598/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.4.1v1"
          } ],
          "description" : "DMARC is not configured through the Exchange admin center, but rather via DNS records hosted by the agency's domain. As such, implementation varies depending on how an agency manages its DNS records. See [Form the DMARC TXT record for your domain \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/email-authentication-dmarc-configure?view=o365-worldwide#step-4-form-the-dmarc-txt-record-for-your-domain) for Microsoft guidance.\n\nA DMARC record published at the second-level domain will protect all subdomains. In other words, a DMARC record published for `example.com` will protect both `a.example.com` and `b.example.com`, but a separate record would need to be published for `c.example.gov`.\n\nTo test your DMARC configuration, consider using one of many publicly available web-based tools. Additionally, DMARC records can be requested using the PowerShell tool `Resolve-DnsName`. For example:\n\n`Resolve-DnsName _dmarc.example.com txt`\n\nIf DMARC is configured, a response resembling `v=DMARC1; p=reject; pct=100; rua=mailto:reports@dmarc.cyber.dhs.gov, mailto:reports@example.com; ruf=mailto:reports@example.com` will be returned, though by necessity, the contents of the record will vary by agency. In this example, the policy indicates all emails failing the SPF/DKIM checks are to be rejected and aggregate reports sent to reports@dmarc.cyber.dhs.gov and reports@example.com. Failure reports will be sent to reports@example.com.",
          "uuid" : "cdf08f07-9b04-4f58-8a0a-5ffaff8d3ea3"
        } ],
        "description" : "Without a DMARC policy available for each domain, recipients may improperly handle SPF and DKIM failures, possibly enabling spoofed emails to reach end users' mailboxes. Publishing DMARC records at the second-level domain protects the second-level domains and all subdomains.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.4.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "7fb46354-13c7-412c-a731-94c5837ab5e4",
        "title" : "The DMARC message rejection option SHALL be p=reject.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo42v1"
        }, {
          "text" : "T1598: Phishing for Information",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1598/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.4.2v1"
          } ],
          "description" : "See [MS.EXO.4.1v1 Instructions](#msexo41v1-instructions) for an overview of how to publish and check a DMARC record. Ensure the record published includes `p=reject`.",
          "uuid" : "399d1aab-9d63-4fa6-a75b-9b21cb632f70"
        } ],
        "description" : "Of the three policy options (i.e., none, quarantine, and reject), reject provides the strongest protection. Reject is the level of protection required by BOD 18-01 for FCEB departments and agencies.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.4.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "14d5fc00-10a7-495a-831b-83a1e4f41146",
        "title" : "The DMARC point of contact for aggregate reports SHALL include \\`reports@dmarc.cyber.dhs.gov\\`.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo43v1"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.4.3v1"
          } ],
          "description" : "See [MS.EXO.4.1v1 Instructions](#msexo41v1-instructions) for an overview of how to publish and check a DMARC record. Ensure the record published includes [reports@dmarc.cyber.dhs.gov](mailto:reports@dmarc.cyber.dhs.gov) as one of the emails for the RUA field.",
          "uuid" : "ecc42104-9c3d-4eca-9b47-b44e923b8380"
        } ],
        "description" : "Email spoofing attempts are not inherently visible to domain owners. DMARC provides a mechanism to receive reports of spoofing attempts. Including [reports@dmarc.cyber.dhs.gov](mailto:reports@dmarc.cyber.dhs.gov) as a point of contact for these reports gives CISA insight into spoofing attempts and is required by BOD 18-01 for FCEB departments and agencies.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.4.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-4.5",
              "statement-ids" : [ "si-4.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "98f48db8-9cb5-4878-b3b6-4118d26f7e0c",
        "title" : "An agency point of contact SHOULD be included for aggregate and failure reports.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo44v1"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.4.4v1"
          } ],
          "description" : "See [MS.EXO.4.1v1 Instructions](#msexo41v1-instructions) for an overview of how to publish and check a DMARC record. Ensure the record published includes: - A point of contact specific to your agency in the RUA field. - [reports@dmarc.cyber.dhs.gov](mailto:reports@dmarc.cyber.dhs.gov) as one of the emails in the RUA field. - One or more agency-defined points of contact in the RUF field.",
          "uuid" : "a479bf7a-7179-4288-ac25-ae7c9b9e172c"
        } ],
        "description" : "Email spoofing attempts are not inherently visible to domain owners. DMARC provides a mechanism to receive reports of spoofing attempts. Including an agency point of contact gives the agency insight into attempts to spoof their domains.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.4.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-4.5",
              "statement-ids" : [ "si-4.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "60ff33ca-8d2e-4c7e-beb3-0c99fefe5e8f",
        "title" : "SMTP AUTH SHALL be disabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo51v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.5.1v1"
          } ],
          "description" : "To disable SMTP AUTH for the organization:",
          "uuid" : "da56518b-8118-4196-8083-3bd96af3af6a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.5.1v1"
          } ],
          "description" : "Sign in to the **Exchange admin center**.",
          "uuid" : "4351032b-057e-4cd7-91e6-ad07903aae4e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.5.1v1"
          } ],
          "description" : "On the left hand pane, select **Settings** ; then from the settings list, select **Mail Flow**.",
          "uuid" : "ca2b5ef1-737e-4c1f-86a2-9ba2e4c8d725"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.5.1v1"
          } ],
          "description" : "Make sure the setting **Turn off SMTP AUTH protocol for your organization** is checked.",
          "uuid" : "d0b994a1-9958-4ac5-b5c3-f768686b5f5b"
        } ],
        "description" : "SMTP AUTH is not used or needed by modern email clients. Therefore, disabling it as the global default conforms to the principle of least functionality.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.5.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "6ec38690-84d2-4871-bc5e-e4f1b4dd0df8",
        "title" : "Contact folders SHALL NOT be shared with all domains.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo61v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.1v1"
          } ],
          "description" : "To restrict sharing with all domains:",
          "uuid" : "dbf6a103-0e75-4048-8adc-416a9d03af19"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.1v1"
          } ],
          "description" : "Sign in to the **Exchange admin center**.",
          "uuid" : "64041ddd-453d-459a-ab94-80d3b750b3d6"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.1v1"
          } ],
          "description" : "On the left-hand pane under **Organization** , select **Sharing**.",
          "uuid" : "5e5e42c6-561e-4e9d-8530-4af1606c4360"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.1v1"
          } ],
          "description" : "Select **Individual Sharing**.",
          "uuid" : "939d18e7-6951-458b-9fd9-74754c7bd915"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.1v1"
          } ],
          "description" : "For all existing policies, select the policy, then select **Manage domains**.",
          "uuid" : "a4571bf2-2309-4ecf-bf78-551b3ed0c2d7"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.1v1"
          } ],
          "description" : "For all sharing rules under all existing policies, ensure **Sharing with all domains** is not selected.",
          "uuid" : "71e55ffb-4ba8-4f97-85fd-f58e1de798df"
        } ],
        "description" : "Contact folders may contain information that should not be shared by default with all domains. Disabling sharing with all domains closes an avenue for data exfiltration while still allowing for specific legitimate use as needed.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.6.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d995a122-da46-4ba5-9b5c-c6526d9de5ff",
        "title" : "Calendar details SHALL NOT be shared with all domains.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo62v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.2v1"
          } ],
          "description" : "To restrict sharing calendar details with all domains:",
          "uuid" : "64461e3c-b65b-4a5d-bf9a-96d3924a4ccc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.6.2v1"
          } ],
          "description" : "Refer to step 5 in [MS.EXO.6.1v1 Instructions](#msexo61v1-instructions) to implement this policy.",
          "uuid" : "d2c0541a-8d96-4240-b425-82bc629219bf"
        } ],
        "description" : "Calendar details may contain information that should not be shared by default with all domains. Disabling sharing with all domains closes an avenue for data exfiltration while still allowing for legitimate use as needed.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.6.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "b40d5483-fd86-4f25-a833-c4cca31018af",
        "title" : "External sender warnings SHALL be implemented.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo71v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "To create a mail flow rule to produce external sender warnings:",
          "uuid" : "4bd1a962-f8b3-4202-afa5-e444de579413"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Sign in to the **Exchange admin center**.",
          "uuid" : "aab9b27a-29c1-4226-b9fa-a71d485d0ccf"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Under **Mail flow** , select **Rules**.",
          "uuid" : "71e51758-061b-4866-a1db-24785e2ee797"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Click the plus (**+**) button to create a new rule.",
          "uuid" : "d0b69851-cca1-439f-a49b-b2a17851ca5a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Select **Modify messages…**.",
          "uuid" : "aef5dba6-11cf-4433-9e34-821984c969bc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Give the rule an appropriate name.",
          "uuid" : "282b83a4-db86-44f7-b09a-249170c60862"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Under **Apply this rule if…,** select **The sender is external/internal**.",
          "uuid" : "dfc7c7b3-d8d4-4bbe-8ac4-0c52fd03f01d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Under **select sender location** , select **Outside the organization** , then click **OK**.",
          "uuid" : "650456a6-2ba6-4ba2-95e4-8bba03639f59"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Under **Do the following…,** select **Prepend the subject of the message with…**.",
          "uuid" : "918c3e86-d6aa-47f7-af19-36d7f0d93417"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Under **specify subject prefix** , enter a message such as \"\\[External\\]\" (without the quotation marks), then click **OK**.",
          "uuid" : "43f33457-8a7c-4359-9802-f39a906a150e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Click **Next**.",
          "uuid" : "28236a85-1e10-4344-8bb7-63c7fd02293c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Under **Choose a mode for this rule** , select **Enforce**.",
          "uuid" : "4ba75ee0-e959-40d2-8160-753c09f332f5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Leave the **Severity** as **Not Specified**.",
          "uuid" : "376f0a2a-af49-481d-8724-d2f1cefac6ef"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Leave the **Match sender address in message** as **Header** and click **Next**.",
          "uuid" : "472dcdf8-1186-444f-a1fd-947c9120b758"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "Click **Finish** and then **Done**.",
          "uuid" : "d10c6768-f0aa-41a1-b83d-d22a3d7ae7c9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.7.1v1"
          } ],
          "description" : "The new rule will be disabled. Re-select the new rule to show its settings and slide the **Enable or disable rule** slider to the right until it shows as **Enabled**.",
          "uuid" : "788aaba0-7313-422c-b38f-51271386312d"
        } ],
        "description" : "Phishing is an ever-present threat. Alerting users when email originates from outside their organization can encourage them to exercise increased caution, especially if an email is one they expected from an internal sender.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.7.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "fc201733-e7d1-4379-b78d-20d5434ce3b8",
        "title" : "A DLP solution SHALL be used.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo81v2"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.8.1v2"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [DLP](./defender.md#implementation-3) for additional guidance.",
          "uuid" : "6bd676eb-5ee5-4103-a63c-71b5d9abdf40"
        } ],
        "description" : "Users may inadvertently disclose sensitive information to unauthorized individuals. A DLP solution may detect the presence of sensitive information in Exchange Online and block access to unauthorized entities.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.8.1v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "dc2ca72b-2214-4aa7-a491-34f81a6d8bf9",
        "title" : "The DLP solution SHALL protect personally identifiable information (PII) and sensitive information, as defined by the agency.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo82v2"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.8.2v2"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [protecting PII](./defender.md#msdefender41v2-instructions) for additional guidance.",
          "uuid" : "339af637-30b4-4e09-927e-69b29c4a8508"
        } ],
        "description" : "Users may inadvertently share sensitive information with others who should not have access to it. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized disclosures.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.8.2v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "9fc8c2f4-2b4a-41f1-83f9-368f75dec5cf",
        "title" : "The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo83v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.8.3v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [DLP](./defender.md#implementation-3) for additional guidance.",
          "uuid" : "34224fdb-4fd8-402d-9795-f89fa09818a9"
        } ],
        "description" : "Any alternative DLP solution should be able to detect sensitive information in Exchange Online and block access to unauthorized entities.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.8.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d83188bd-8715-4d85-b29b-20a484ffa192",
        "title" : "At a minimum, the DLP solution SHALL restrict sharing credit card numbers, U.S. Individual Taxpayer Identification Numbers (ITIN), and U.S. Social Security numbers (SSN) via email.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo84v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.8.4v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [protecting PII](./defender.md#msdefender41v2-instructions) for additional guidance.",
          "uuid" : "cac47122-3e6c-4541-9361-dbca4b853b2c"
        } ],
        "description" : "Users may inadvertently share sensitive information with others who should not have access to it. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized disclosures.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.8.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "eebb636b-bfed-4542-80c4-055fbcb9705f",
        "title" : "Emails SHALL be filtered by attachment file types.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo91v2"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.9.1v2"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which include email filtering based on attachment file type.",
          "uuid" : "a1d36dfe-92bf-487e-89ff-1dc32cc28ecb"
        } ],
        "description" : "Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.9.1v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "082afd69-3a76-4b4e-b22d-36da1e9dd57a",
        "title" : "The attachment filter SHOULD attempt to determine the true file type and assess the file extension.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo92v1"
        }, {
          "text" : "T1036: Masquerading",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1036/"
        }, {
          "text" : "T1036.006: Space after Filename",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1036/006/"
        }, {
          "text" : "T1036.007: Double File Extension",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1036/007/"
        }, {
          "text" : "T1036.008: Masquerade File Type",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1036/008/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.9.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which attempt to determine the true file type and assess the file extension.",
          "uuid" : "b5b69838-edd2-4b0b-902c-7a7f5ec5b59e"
        } ],
        "description" : "Users can change a file extension at the end of a file name (e.g., notepad.exe to notepad.txt) to obscure the actual file type. Verifying the file type and checking that this matches the designated file extension can help detect instances where the file extension was changed.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.9.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "87fe9609-43f8-448b-af99-7dbb9e15d794",
        "title" : "Disallowed file types SHALL be determined and enforced.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo93v2"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.9.3v2"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which disallow click-to-run file types.",
          "uuid" : "b33c1738-17cc-43c9-ac71-897063ea2d15"
        } ],
        "description" : "Malicious attachments often take the form of click-to-run files, though other file types can contain malicious content as well. As such, determining the full list of file types to block is left to each organization, to be made in accordance with their risk tolerance.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.9.3v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "04b7bd39-7dc0-4f17-b8b1-a39a27217ba1",
        "title" : "Alternatively chosen filtering solutions SHOULD offer services comparable to Microsoft Defender's Common Attachment Filter.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo94v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.9.4v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which disallow click-to-run file types.",
          "uuid" : "36a2d679-b42a-474d-8197-41b6c0b45444"
        } ],
        "description" : "Malicious attachments often take the form of click-to-run files. Sharing high risk file types, when necessary, is better left to a means other than email; the dangers of allowing them to be sent over email outweigh any potential benefits. Filtering email attachments based on file types can prevent spread of malware distributed via click-to-run email attachments.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.9.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "b5b16ab7-e610-4712-b04e-8d69ebc54287",
        "title" : "At a minimum, click-to-run files SHOULD be blocked (e.g., .exe, .cmd, and .vbe).",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo95v1"
        }, {
          "text" : "Common attachments filter in anti-malware policies \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/defender-office-365/anti-malware-protection-about#common-attachments-filter-in-anti-malware-policies"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.9.5v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which disallow click-to-run file types.",
          "uuid" : "d018166f-e664-4a00-a44e-522ed60dc28a"
        } ],
        "description" : "Malicious attachments often take the form of click-to-run files. Blocking a list of common executable files helps mitigate the risk of adversarial exploitation.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.9.5v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "3b6f497a-7dee-44e7-b7a6-c00afabf62b0",
        "title" : "Emails SHALL be scanned for malware.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo101v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.10.1v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which include anti-malware protection.",
          "uuid" : "62cf8f65-4b02-4da0-ba4f-9bc32bc45d7e"
        } ],
        "description" : "Email can be used as a mechanism for delivering malware. In many cases, malware can be detected through scanning, reducing the risk for end users.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.10.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "34d7e9f9-2c90-4175-93f6-41102e8dbd5a",
        "title" : "Emails identified as containing malware SHALL be quarantined or dropped.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo102v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.10.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which include anti-malware protection to quarantine malware in email.",
          "uuid" : "ca5e3071-107e-409e-af41-0278901ab6b0"
        } ],
        "description" : "Email can be used as a mechanism for delivering malware. Preventing emails with known malware from reaching user mailboxes helps ensure users cannot interact with those emails.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.10.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "54c5f4ef-9d32-4bf9-8b40-0510b4da2d13",
        "title" : "Email scanning SHALL be capable of reviewing emails after delivery.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo103v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.10.3v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#implementation), which include zero-hour auto purge (ZAP) to retroactively detect malware in messages already delivered to mailboxes and removes them.",
          "uuid" : "6e52885e-0e27-474a-9574-12ed993b58ba"
        } ],
        "description" : "As known malware signatures are updated, it is possible for an email to be retroactively identified as containing malware after delivery. By scanning emails, the number of malware-infected in users' mailboxes can be reduced.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.10.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "c7406e3b-cd77-43b5-8bd0-8944d88b9fd1",
        "title" : "Impersonation protection checks SHOULD be used.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo111v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.11.1v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling impersonation protection](./defender.md#msdefender21v1-instructions).",
          "uuid" : "f14bd8e1-9a0c-405c-8512-2f910359350f"
        } ],
        "description" : "Users might not be able to reliably identify phishing emails, especially if the `FROM` address is nearly indistinguishable from that of a known entity. By automatically identifying senders who appear to be impersonating known senders, the risk of a successful phishing attempt can be reduced.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.11.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "53e1b970-a9fa-4144-8567-974da079c8ac",
        "title" : "User warnings, comparable to the user safety tips included with EOP, SHOULD be displayed.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo112v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.11.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender12v1) which include user safety tips to warn users.",
          "uuid" : "afba05d6-12ac-4333-9347-7402380cffc4"
        } ],
        "description" : "Many tasks are better suited for automated processes, such as identifying unusual characters in the `FROM` address or identifying a first-time sender. User warnings can handle these tasks, reducing the burden on end users and the risk of successful phishing attempts.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.11.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "at-2",
              "statement-ids" : [ "at-2_smt.b" ]
            }, {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "546f2cf9-b557-445d-921e-5312c7410fbf",
        "title" : "The phishing protection solution SHOULD include an AI-based phishing detection tool comparable to EOP Mailbox Intelligence.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo113v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1656: Impersonation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1656/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.11.3v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender13v1) which include mailbox intelligence for detecting phishing attacks using AI.",
          "uuid" : "055e706a-6fe9-43e3-ad9f-c2b3b0e4a7a9"
        } ],
        "description" : "Phishing attacks can result in unauthorized data disclosure and unauthorized access. Using AI-based phishing detection tools to improve the detection rate of phishing attempts helps reduce the risk of successful phishing attacks.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.11.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "014aa1b4-f05d-4f7f-a224-f4398563efda",
        "title" : "IP allow lists SHOULD NOT be created.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo121v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "To modify the connection filters, follow the instructions found in [Use the Microsoft 365 Defender portal to modify the default connection filter policy](https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/connection-filter-policies-configure?view=o365-worldwide#use-the-microsoft-365-defender-portal-to-modify-the-default-connection-filter-policy).",
          "uuid" : "fc273d98-b4a7-4028-9728-e057979bcf88"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender portal**.",
          "uuid" : "8dfe746f-3a94-4eef-a929-c55c5b883a6c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "From the left-hand menu, find **Email \\& collaboration** and select **Policies and Rules**.",
          "uuid" : "d676315f-80d7-48a6-8410-d125985e064d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "Select **Threat Policies** from the list of policy names.",
          "uuid" : "57e8230f-cb21-4789-bd18-3e48753853e8"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "Under **Policies** , select **Anti-spam**.",
          "uuid" : "98d01866-cb18-4c08-acd8-cccff0a406f4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "Select **Connection filter policy (Default)**.",
          "uuid" : "bff6d9fd-41f9-4a84-b285-fda3b79c07d4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "Click **Edit connection filter policy**.",
          "uuid" : "6ccd1361-c836-4f6e-b59e-99377e6e3707"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "Ensure no addresses are specified under **Always allow messages from the following IP addresses or address range**.",
          "uuid" : "6f2098d3-b583-4a46-b146-33693c25dfdd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.1v1"
          } ],
          "description" : "Ensure **Turn on safe list** is not selected.",
          "uuid" : "f78e36a9-0fdf-403b-a6ae-dc9f71e21014"
        } ],
        "description" : "Messages sent from IP addresses on an allow list bypass important security mechanisms, including spam filtering and sender authentication checks. Avoiding use of IP allow lists prevents potential threats from circumventing security mechanisms.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.12.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-4",
              "statement-ids" : [ "ac-4_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "106466fe-85dc-43e3-bd06-0cefd18e2e05",
        "title" : "Safe lists SHOULD NOT be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo122v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "Sign in to **Microsoft 365 Defender portal**.",
          "uuid" : "2729b5ad-10d7-4b23-a606-591cbc911a73"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "From the left-hand menu, find **Email \\& collaboration** and select **Policies and Rules**.",
          "uuid" : "e624ba87-a337-4ce4-9050-0423d00f5b4e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "Select **Threat Policies** from the list of policy names.",
          "uuid" : "484cf220-4bd0-456f-8f32-2875cf941b4f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "Under **Policies** , select **Anti-spam**.",
          "uuid" : "70fad694-07fd-46f7-89f0-284b0d54e1d3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "Select **Connection filter policy (Default)**.",
          "uuid" : "dc07b8a4-4598-4265-b405-e84b9c30191b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "Click **Edit connection filter policy**.",
          "uuid" : "a7bccb4a-5794-40a9-9fdf-6d3c07c893b5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "(Optional) Enter addresses under **Always block messages from the following IP addresses or address range** as needed.",
          "uuid" : "f5600097-da5b-4cdc-8cdb-655e8848e1fb"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.12.2v1"
          } ],
          "description" : "Ensure **Turn on safe list** is not selected.",
          "uuid" : "fb6a2aca-9927-4c11-b2e1-61eb4661d03d"
        } ],
        "description" : "Messages sent from allowed safe list addresses bypass important security mechanisms, including spam filtering and sender authentication checks. Avoiding use of safe lists prevents potential threats from circumventing security mechanisms. While blocking all malicious senders is not feasible, blocking specific known, malicious IP addresses may reduce the threat from specific senders.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.12.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-4",
              "statement-ids" : [ "ac-4_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a720e45a-7475-48ae-8b53-a22ff7cdbff6",
        "title" : "Mailbox auditing SHALL be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo131v1"
        }, {
          "text" : "T1070: Indicator Removal",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1070/"
        }, {
          "text" : "T1070.008: Clear Mailbox Data",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1070/008/"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.002: Additional Email Delegate Permissions",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/002/"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.008: Disable or Modify Cloud Logs",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/008/"
        }, {
          "text" : "T1586: Compromise Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1586/"
        }, {
          "text" : "T1586.002: Email Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1586/002/"
        }, {
          "text" : "T1564: Hide Artifacts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1564/"
        }, {
          "text" : "T1564.008: Email Hiding Rules",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1564/008/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.13.1v1"
          } ],
          "description" : "Mailbox auditing can be managed from the Exchange Online PowerShell. Follow the instructions listed on [Manage mailbox auditing in Office 365](https://learn.microsoft.com/en-us/microsoft-365/compliance/audit-mailboxes?view=o365-worldwide).\n\nTo check the current mailbox auditing status for your organization via PowerShell:",
          "uuid" : "7ad13d05-2d0c-4163-9707-3e66b6fc6254"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.13.1v1"
          } ],
          "description" : "Connect to the Exchange Online PowerShell.",
          "uuid" : "f4bff882-82a8-4b02-b35f-26dcb8370120"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.13.1v1"
          } ],
          "description" : "Run the following command:\n\n    `Get-OrganizationConfig | Format-List AuditDisabled`",
          "uuid" : "2f33ed29-458c-4be0-97c0-3d83875ced76"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.13.1v1"
          } ],
          "description" : "An `AuditDisabled : False` result indicates mailbox auditing is enabled.\n\nTo enable mailbox auditing by default for your organization via PowerShell:",
          "uuid" : "642cca59-1593-4abc-9266-389c570aff95"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.13.1v1"
          } ],
          "description" : "Connect to the Exchange Online PowerShell.",
          "uuid" : "deeca819-3a9d-4848-afaf-63134f5c1aa1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.13.1v1"
          } ],
          "description" : "Run the following command:\n\n    `Set-OrganizationConfig –AuditDisabled $false`",
          "uuid" : "79e7c09c-b98a-4a7a-97ca-a50b2fed7731"
        } ],
        "description" : "Exchange Online user accounts can be compromised or misused. Enabling mailbox auditing provides a valuable source of information to detect and respond to mailbox misuse.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.13.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "au-12",
              "statement-ids" : [ "au-12_smt.c" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "83351964-2ad5-4137-8621-c10848dfb1a3",
        "title" : "A spam filter SHALL be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo141v2"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.14.1v2"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender12v1), which include spam filtering.",
          "uuid" : "cfab7dce-657d-4396-b82e-54b74a95cc32"
        } ],
        "description" : "Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Filtering out spam reduces user workload burden, prevents junk mail congestion, and reduces potentially malicious content exposure.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.14.1v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "dbb8710a-bef9-439b-8782-2d875dd6ccdd",
        "title" : "Spam and high confidence spam SHALL be moved to either the junk email folder or the quarantine folder.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo142v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.14.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender12v1), which include spam filtering that moves high confidence spam to either the junk or quarantine folder.",
          "uuid" : "6239b9d6-4b2c-4b81-9484-e129b295db89"
        } ],
        "description" : "Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Moving spam messages to a separate junk or quarantine folder helps users filter out spam while still giving them the ability to review messages, as needed, in case a message is filtered incorrectly.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.14.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "5b9fda59-47d1-479d-b82c-7d9398723f4a",
        "title" : "Allowed domains SHALL NOT be added to inbound anti-spam protection policies.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo143v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.14.3v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender12v1), which do not include any allowed sender domains by default.",
          "uuid" : "b8c53e50-5be8-4b66-825f-27dbc8bf3219"
        } ],
        "description" : "Legitimate emails may be incorrectly filtered by spam protections. Adding allowed senders is an acceptable method of combating these false positives. Allowing an entire domain, especially a common domain like office.com, however, provides for a large number of potentially unknown users to bypass spam protections.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.14.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "eb806a15-225f-427b-a4c3-9aec647bdd29",
        "title" : "If a third-party party filtering solution is used, the solution SHOULD offer services comparable to the native spam filtering offered by Microsoft.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo144v1"
        }, {
          "text" : "Configure anti-spam policies in EOP \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/defender-office-365/anti-spam-policies-configure?view=o365-worldwide"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.14.4v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender12v1), which include spam filtering.",
          "uuid" : "fed83e4b-b29a-4572-a505-cddec3f1c3b7"
        } ],
        "description" : "Spam is a constant threat as junk mail can reduce user productivity, fill up mailboxes unnecessarily, and in some cases include malicious links or attachments. Filtering out spam reduces user workload burden, prevents junk mail congestion, and reduces potentially malicious content exposure.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.14.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "1a11d8ee-5d14-4d00-b09d-18f4fbc31a55",
        "title" : "URL comparison with a block-list SHOULD be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo151v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.15.1v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender for Office 365, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender13v1), which include Safe Links protections to scan URLs in email messages against a list of known, malicious links.",
          "uuid" : "bee12556-8190-476d-a350-25f3752272ab"
        } ],
        "description" : "Users may be directed to malicious websites via links in email. Blocking access to known, malicious URLs can prevent users from accessing known malicious websites.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.15.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "7e9aca76-dc41-45dc-8455-c62846e2903d",
        "title" : "Direct download links SHOULD be scanned for malware.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo152v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.15.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender for Office 365, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender13v1), which include Safe Links protections to scan links to files for malware.",
          "uuid" : "0861a466-820d-426b-bfc2-21002751ac1b"
        } ],
        "description" : "URLs in emails may direct users to download and run malware. Scanning direct download links in real-time for known malware and blocking access can prevent users from infecting their devices.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.15.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "7a55b8cc-86ec-4620-b0e9-445d05e65d79",
        "title" : "User click tracking SHOULD be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo153v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.15.3v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender for Office 365, see the following implementation steps for [enabling preset security policies](./defender.md#msdefender13v1), which include Safe Links click protections to track user clicks on links in email.",
          "uuid" : "c37db3c2-abee-4afa-bd78-d8f3fd20cabc"
        } ],
        "description" : "Users may click on malicious links in emails, leading to compromise or unauthorized data disclosure. Enabling user click tracking lets agencies know if a malicious link may have been visited after the fact to help tailor a response to a potential incident.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.15.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            }, {
              "control-id" : "au-12",
              "statement-ids" : [ "au-12_smt.c" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "132e7976-3eb5-4a86-a6f3-a0b1ea636bf1",
        "title" : "At a minimum, the following alerts SHALL be enabled:",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo161v1"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.002: Spearphishing Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/002/"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.006: Indicator Blocking",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/006/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.16.1v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft 365 alert policies, see the following implementation steps for [enabling alerts](./defender.md#msdefender51v1-instructions) for additional guidance.",
          "uuid" : "6b922b3f-7fbd-4a6e-acfe-7a66fe974cb9"
        } ],
        "description" : "Potentially malicious or service impacting events may go undetected without a means of detecting these events. Setting up a mechanism to alert administrators to events listed above draws attention to them to help minimize impact to users and the agency.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.16.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-4.5",
              "statement-ids" : [ "si-4.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "54759e72-856a-4bbc-abb0-59abff582079",
        "title" : "The alerts SHOULD be sent to a monitored address or incorporated into a security information and event management (SIEM) system.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo162v1"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.006: Indicator Blocking",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/006/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.16.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft 365 alert policies, see the following implementation steps to [add email recipients to an alert](./defender.md#msdefender51v1-instructions) for additional guidance.",
          "uuid" : "3da4124e-63f4-4e3f-88fe-4f91e8c40c27"
        } ],
        "description" : "Suspicious or malicious events, if not resolved promptly, may have a greater impact to users and the agency. Sending alerts to a monitored email address or SIEM system helps ensure these suspicious or malicious events are acted upon in a timely manner to limit overall impact.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.16.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-4.12",
              "statement-ids" : [ "si-4.12_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "2bdcc44f-5817-42a2-9f69-2f9149bcd27b",
        "title" : "Unified Audit logging SHALL be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo171v1"
        }, {
          "text" : "T1562: Impair Defenses",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/"
        }, {
          "text" : "T1562.008: Disable or Modify Cloud Logs",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1562/008/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.17.1v1"
          } ],
          "description" : "See the following implementation steps for enabling [Unified Audit logging](./defender.md#msdefender61v1-instructions) for additional guidance.",
          "uuid" : "076e52be-cdd1-4c70-b1e3-b746a7f6c6ff"
        } ],
        "description" : "Responding to incidents without detailed information about activities that took place slows response actions. Enabling Unified Audit logging helps ensure agencies have visibility into user actions. Furthermore, enabling the Unified Audit log is required for government agencies by OMB M-21-31.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.17.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "au-12",
              "statement-ids" : [ "au-12_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "adf50ee3-f2ad-439b-882e-1d2013920a21",
        "title" : "Audit logs SHALL be maintained for at least the minimum duration dictated by OMB M-21-31 (Appendix C).",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/exo.md#msexo173v1"
        }, {
          "text" : "Export, configure, and view audit log records \\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/purview/audit-log-export-records"
        }, {
          "text" : "Untitled Goose Tool Fact Sheet \\| CISA.",
          "rel" : "reference",
          "href" : "https://www.cisa.gov/resources-tools/resources/untitled-goose-tool-fact-sheet"
        }, {
          "text" : "Manage audit log retention policies \\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/purview/audit-log-retention-policies?tabs=microsoft-purview-portal#before-you-create-an-audit-log-retention-policy"
        }, {
          "text" : "T1070: Indicator Removal",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1070/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.EXO.17.3v1"
          } ],
          "description" : "See the following implementation steps to [create an audit retention policy](./defender.md#msdefender63v1-instructions) for additional guidance.\n\n**`TLP:CLEAR`**",
          "uuid" : "6cb34988-65e9-448b-9813-0b2de9ecbeb7"
        } ],
        "description" : "Audit logs may no longer be available when needed if they are not retained for a sufficient time. Increased log retention time gives an agency the necessary visibility to investigate incidents that occurred some time ago. OMB M-21-13, Appendix C, Table 5 specifically calls out Unified Audit Logs in the Cloud Azure log category.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.EXO.17.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "exo"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "au-11",
              "statement-ids" : [ "au-11_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "d5e97c24-d67f-45e2-8f59-5d0f1f0e1eb3",
        "title" : "The Publish to Web feature SHOULD be disabled unless the agency mission requires the capability.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi11v1"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.1.1v1"
          } ],
          "description" : "Navigate to the **PowerBI Admin Portal**",
          "uuid" : "e9eec624-83e1-40f4-9c12-f37f7d1e41ab"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.1.1v1"
          } ],
          "description" : "Click on **Tenant Settings**",
          "uuid" : "e90c3c3c-6532-4c2f-9b14-ba26959ae7cc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.1.1v1"
          } ],
          "description" : "Scroll to **Export and sharing settings**",
          "uuid" : "118b5868-355b-461d-99ef-362afadb32f4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.1.1v1"
          } ],
          "description" : "Click **Publish to web** set to **Disabled**",
          "uuid" : "6c73ebe2-87a6-4bc3-8051-85c62f72993a"
        } ],
        "description" : "A publicly accessible web URL can be accessed by everyone, including malicious actors. This policy limits information available on the public web that is not specifically allowed to be published.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.1.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            }, {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "f31ff132-91fc-4a0c-9987-b8663686a4fd",
        "title" : "Guest user access to the Power BI tenant SHOULD be disabled unless the agency mission requires the capability.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi21v1"
        }, {
          "text" : "T1485: Data Destruction",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1485/"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1565.001: Stored Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/001/"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.001: Default Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "To Disable Completely: 1. Navigate to the **PowerBI Admin Portal**",
          "uuid" : "d8933d76-788d-4a0b-ac1d-2fef6a75ed27"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "Click on **Tenant Settings**",
          "uuid" : "4fe8fac8-fcec-4004-8582-e38ccc660631"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "Scroll to **Export and sharing settings**",
          "uuid" : "55f7e689-0a73-47bb-bad9-3c73ce8d336b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "Click on **Allow Microsoft Entra guest users to edit and manage content in the organization** and set to **Disabled**\n\nTo Enable with Security Group(s): 1. Navigate to the **PowerBI Admin Portal**",
          "uuid" : "0ac1420b-8db4-4fe1-af39-16e000c093d3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "Click on **Tenant Settings**",
          "uuid" : "205a48ff-41fa-4cf1-a7b3-d743a37ccf75"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "Scroll to **Export and sharing settings**",
          "uuid" : "e05e6951-8115-4f9e-8e78-1a7df63ca6ea"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "Click on **Allow Microsoft Entra guest users to edit and manage content in the organization** and set to **Enabled**",
          "uuid" : "665d9989-4d72-4bb3-8395-189c20e06df9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.2.1v1"
          } ],
          "description" : "Select the security group(s) you want to have access to the PowerBI tenant.\n\n> Note: You may need to make a specific security group(s)",
          "uuid" : "d67d0d3d-479f-446e-a914-0c24f79633fa"
        } ],
        "description" : "Disabling external access to Power BI helps keep guest users from accessing potentially risky data and application programming interfaces (APIs). If an agency needs to allow guest access, this can be limited to users in specific security groups to curb risk.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.2.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            }, {
              "control-id" : "ac-6",
              "statement-ids" : [ "ac-6_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "1ca3d602-6950-4faf-b9d8-69985fcecd16",
        "title" : "The Invite external users to your organization feature SHOULD be disabled unless agency mission requires the capability.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi31v1"
        }, {
          "text" : "T1485: Data Destruction",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1485/"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1565.001: Stored Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/001/"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.001: Default Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/001/"
        }, {
          "text" : "T1199: Trusted Relationship",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1199/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "To disable completely: 1. Navigate to the **PowerBI Admin Portal**",
          "uuid" : "c8a16da7-0f7f-4fd8-b5f3-ac86e84d637b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "Click on **Tenant Settings**",
          "uuid" : "c0426a1e-8db2-44a5-9cc3-0e61465fa5c4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "Scroll to **Export and sharing settings**",
          "uuid" : "d8872c46-258b-43b8-82ca-c3710b4be2cc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "Click on **Invite external users to your organization** and set to **Disabled**\n\nTo enable with security groups: 1. Navigate to the **PowerBI Admin Portal**",
          "uuid" : "5cac4c7b-4172-40b6-8286-597441ad0178"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "Click on **Tenant Settings**",
          "uuid" : "a89d7460-9b1f-4ad3-a6a4-cf7bb22e8c97"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "Scroll to **Export and sharing settings**",
          "uuid" : "21271027-42da-487d-b9d5-14e9ba573efd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "Click on **Invite external users to your organization** and set to **Enabled**",
          "uuid" : "84a3fe86-7e2f-4a29-8f92-0a1f108643e1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.3.1v1"
          } ],
          "description" : "Select the security group(s) needed.\n\n> Note: You may need to make a specific security group(s)",
          "uuid" : "9bacbfba-28e8-4a96-abb6-4c5ff0d38c39"
        } ],
        "description" : "Disabling this feature keeps internal users from inviting guest users. Therefore guest users can be limited from accessing potentially risky data/APIs. If an agency needs to allow guest access, the invitation feature can be limited to users in specific security groups to help limit risk.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.3.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            }, {
              "control-id" : "ac-6",
              "statement-ids" : [ "ac-6_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "ddfb0d79-1f4d-4bcc-978f-5b787b0f28b7",
        "title" : "Service principals with access to APIs SHOULD be restricted to specific security groups.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi41v1"
        }, {
          "text" : "T1059: Command and Scripting Interpreter",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1059/"
        }, {
          "text" : "T1059.009: Cloud API",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1059/009/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.1v1"
          } ],
          "description" : "Navigate to the **PowerBI Admin Portal**",
          "uuid" : "6be93251-ea2b-4014-8305-50b690a57e14"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.1v1"
          } ],
          "description" : "Click on **Tenant settings**",
          "uuid" : "9fb82c82-5c38-43c5-aa6d-eda82daf7a7d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.1v1"
          } ],
          "description" : "Scroll to **Developer settings**",
          "uuid" : "72e5c767-4dc1-4ed9-af04-1ea5f44f72db"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.1v1"
          } ],
          "description" : "Click on **Allow service principals to use Power BI APIs** set to **Enabled**. Choose a specific security group allowed to use service principles for the APIs.",
          "uuid" : "933ce07c-e566-4bab-9aee-6485eeca443c"
        } ],
        "description" : "With unrestricted service principals, unwanted access to APIs is possible. Allowing service principals through security groups, and only where necessary, mitigates this risk.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.4.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-4",
              "statement-ids" : [ "ac-4_smt" ]
            }, {
              "control-id" : "ac-6.5",
              "statement-ids" : [ "ac-6.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "e366dc51-d989-4c48-ac24-ef34672331d1",
        "title" : "Service principals creating and using profiles SHOULD be restricted to specific security groups.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi42v1"
        }, {
          "text" : "T1098: Account Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/"
        }, {
          "text" : "T1098.003: Additional Cloud Roles",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1098/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.2v1"
          } ],
          "description" : "Navigate to the **PowerBI Admin Portal**",
          "uuid" : "9e42635e-0006-4688-9966-80ade9363d96"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.2v1"
          } ],
          "description" : "Click on **Tenant settings**",
          "uuid" : "7eff3603-d88b-4dbf-818f-d35e795f235f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.2v1"
          } ],
          "description" : "Scroll to **Developer settings**",
          "uuid" : "5e1ceb96-22a7-42a4-b567-ef139d0d6d36"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.4.2v1"
          } ],
          "description" : "Then, click on **Allow service principals to create and use profiles** and set to **Enabled**. Choose a specific security group allowed to use service principles to create and use profiles",
          "uuid" : "594ac8b5-34db-411d-93e0-99dbfc6b39c2"
        } ],
        "description" : "With unrestricted service principals creating/using profiles, there is risk of an unauthorized user using a profile with more permissions than they have. Allowing service principals through security groups will mitigate that risk.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.4.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-4",
              "statement-ids" : [ "ac-4_smt" ]
            }, {
              "control-id" : "ac-6.5",
              "statement-ids" : [ "ac-6.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "1f493a2a-b425-46da-98cd-469282519887",
        "title" : "ResourceKey-based authentication SHOULD be blocked unless a specific use case (e.g., streaming and/or PUSH datasets) merits its use.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi51v1"
        }, {
          "text" : "T1134: Access Token Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1134/"
        }, {
          "text" : "T1134.001: Token Impersonation/Theft",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1134/001/"
        }, {
          "text" : "T1134.003: Make and Impersonate Token",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1134/003/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.5.1v1"
          } ],
          "description" : "Navigate to the **PowerBI Admin Portal**",
          "uuid" : "5de8d8c0-e6d0-4b7b-bb40-72825346eea5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.5.1v1"
          } ],
          "description" : "Click on **Tenant settings**",
          "uuid" : "82201b4a-d9c2-4e45-9f4a-719a2b438bfc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.5.1v1"
          } ],
          "description" : "Scroll to **Developer settings**",
          "uuid" : "be2f6181-f0c3-466b-9fac-e1f93729c7a0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.5.1v1"
          } ],
          "description" : "Click on **Block ResourceKey Authentication** and set to **Enabled**",
          "uuid" : "9228d8b8-ab0b-493e-85f5-44465131f1b4"
        } ],
        "description" : "If resource keys are allowed, someone can move data without Microsoft Entra ID OAuth bearer token, causing possibly malicious or junk data to be stored. Disabling resource keys reduces risk that an unauthorized individual will make changes.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.5.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            }, {
              "control-id" : "ia-5",
              "statement-ids" : [ "ia-5_smt.g" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "71b72c3d-c574-4fe9-8cea-0f417b030ea6",
        "title" : "Python and R interactions SHOULD be disabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi61v1"
        }, {
          "text" : "T1059: Command and Scripting Interpreter",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1059/"
        }, {
          "text" : "T1059.009: Cloud API",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1059/009/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.6.1v1"
          } ],
          "description" : "Navigate to the **PowerBI Admin Portal**",
          "uuid" : "44a1b750-3c5c-40ad-ae2f-15de625e7795"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.6.1v1"
          } ],
          "description" : "Click on **Tenant settings**",
          "uuid" : "d265d439-6c86-4f37-bb50-9923852a7534"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.6.1v1"
          } ],
          "description" : "Scroll to **R and Python Visuals Settings**",
          "uuid" : "90a544b8-6b80-4494-82d0-c045089f2767"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.6.1v1"
          } ],
          "description" : "Click on **Interact with and share R and Python visuals** and set to **Disabled**",
          "uuid" : "5d169e69-e4f2-4ac0-809a-a68656398668"
        } ],
        "description" : "External code poses a security and privacy risk as there is no good way to regulate what is done with the data or integrations. Disabling this will reduce the risk of a data leak or malicious actor.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.6.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            }, {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "2757c764-1c82-482c-9b73-6c73097c29e5",
        "title" : "Sensitivity labels SHOULD be enabled for Power BI and employed for sensitive data per enterprise data protection policies.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerbi.md#mspowerbi71v1"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.7.1v1"
          } ],
          "description" : "Navigate to the **PowerBI Admin Portal**",
          "uuid" : "252f9678-c42f-426a-89f0-2a3b6f342ac3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.7.1v1"
          } ],
          "description" : "Click on **Tenant settings**",
          "uuid" : "75ee3710-3a21-47fc-98eb-685752e57b3b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.7.1v1"
          } ],
          "description" : "Scroll to **Information protection**",
          "uuid" : "6377adb1-0a5e-4392-b1cb-5d6552cc897f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERBI.7.1v1"
          } ],
          "description" : "Click on **Allow users to apply sensitivity labels for content** and set to **Enabled** Define who can apply and change sensitivity labels in Power BI assets.\n\n# Appendix A: Implementation Considerations",
          "uuid" : "b42cd7c4-35ee-46ef-931f-cd3604463245"
        } ],
        "description" : "A document without sensitivity labels may be opened unknowingly, potentially exposing data to someone who is not supposed to have access to it. This policy will help organize and classify data, making it easier to keep data out of the wrong hands.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERBI.7.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerbi"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-21",
              "statement-ids" : [ "ac-21_smt.b" ]
            }, {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "f622f2f3-29d2-4d04-8bc0-145c1002005a",
        "title" : "The ability to create production and sandbox environments SHALL be restricted to admins.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform11v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.1.1v1"
          } ],
          "description" : "Sign in to your tenant environment's respective [Power Platform admin center](https://learn.microsoft.com/en-us/power-platform/admin/powerapps-us-government#power-apps-us-government-service-urls).",
          "uuid" : "4d955d08-876f-45c7-b35a-6fcc0892157e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.1.1v1"
          } ],
          "description" : "In the upper-right corner of the Microsoft Power Platform site, select the **Gear icon** (Settings icon).",
          "uuid" : "26f26282-badc-4d94-bf8a-5ecbdc996a04"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.1.1v1"
          } ],
          "description" : "Select **Power Platform settings**.",
          "uuid" : "00193f75-0ea6-4b42-8288-59484d5bba95"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.1.1v1"
          } ],
          "description" : "Under **Who can create production and sandbox environments** , select **Only specific admins.**",
          "uuid" : "b8f540e5-ee67-411a-82be-cfc519847903"
        } ],
        "description" : "Users creating new Power Platform environments may inadvertently bypass data loss prevention (DLP) policy settings or misconfigure the security settings of their environment.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERPLATFORM.1.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerplatform"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.10",
              "statement-ids" : [ "ac-6.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "ddd89130-6ea8-43df-858b-67ea29fc57a1",
        "title" : "The ability to create trial environments SHALL be restricted to admins.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform12v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.1.2v1"
          } ],
          "description" : "Follow the MS.POWERPLATFORM.1.1v1 instructions up to step **3**.",
          "uuid" : "cd259e6d-7887-49b4-a5ff-8f42e41c1ace"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.1.2v1"
          } ],
          "description" : "Under **Who can create trial environments** , select **Only specific admins.**",
          "uuid" : "ffc0f6b1-541f-43c0-b915-0eaf14329452"
        } ],
        "description" : "Users creating new Power Platform environments may inadvertently bypass DLP policy settings or misconfigure the security settings of their environment.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERPLATFORM.1.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerplatform"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6.10",
              "statement-ids" : [ "ac-6.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "3faaae19-f0b7-4b85-bcba-8888fe9ba578",
        "title" : "A DLP policy SHALL be created to restrict connector access in the default Power Platform environment.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform21v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "Sign in to your tenant environment's respective [Power Platform admin center](https://learn.microsoft.com/en-us/power-platform/admin/powerapps-us-government#power-apps-us-government-service-urls).",
          "uuid" : "d2a59228-646b-4639-b362-591385045f1c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "On the left pane, select **Policies** \\> **Data Policies.**",
          "uuid" : "8e0527e3-7745-433f-a6a1-e805970f95a0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "Select the **+ New Policy** icon to create a new policy.",
          "uuid" : "75284158-ffef-4074-a9e5-55160aa116ef"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "Give the policy a suitable agency name and click **Next.**",
          "uuid" : "d67a18fc-e3fc-469d-ae8b-3145092f7467"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "At the **Prebuilt connectors** section, search and select the connectors currently in the **Non-business \\| default** tab containing sensitive data that can be utilized to create flows and apps.",
          "uuid" : "6b249860-c1da-461a-bbed-cc36bb5887f9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "Click **Move to Business.** Connectors added to this group can not share data with connectors in other groups because connectors can reside in only one data group at a time.",
          "uuid" : "468524d4-506d-4a13-b4a7-e40412156140"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "If necessary (and possible) for the connector, click **Configure connector** at the top of the screen to change connector permissions. This allows greater flexibility for the agency to allow and block certain connector actions for additional customization.",
          "uuid" : "758afa46-9e8b-4851-8f2d-0d6ff2b6b2e1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "For the default environment, move all other connectors to the **Blocked** category. For non-blockable connectors noted above, the Block action will be grayed out and a warning will appear.",
          "uuid" : "eea6a1e7-225b-487c-a472-b009cbaeb9ec"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "At the bottom of the screen, select **Next** to move on.",
          "uuid" : "74b1877a-7e8d-4055-a139-76754bb949c0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "Add a custom connector pattern. Custom connectors allow admins to specify an ordered list of Allow and Deny URL patterns for custom connectors. View [DLP for custom connectors \\\\\\| Microsoft Learn](https://learn.microsoft.com/en-us/power-platform/admin/dlp-custom-connector-parity?WT.mc_id=ppac_inproduct_datapol) for more information.",
          "uuid" : "919b2932-4573-4a20-a09e-075b27f8632c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "Click **Next**.",
          "uuid" : "7142cd56-c78e-408d-976c-3a65452963c7"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "At the **Scope** section for the default environment, select **Add multiple environments** and add the default environment.",
          "uuid" : "2b9c1a63-f907-487b-b444-b5124980800f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.1v1"
          } ],
          "description" : "Select **Next** -\\> **Create Policy** to finish.",
          "uuid" : "cc35b9b2-b2fc-418a-8533-712aefdbc467"
        } ],
        "description" : "All users in the tenant have access to the default Power Platform environment. Those users may inadvertently use connectors that share sensitive information with others who should not have access to it. Users requiring Power Apps should be directed to conduct development in other Power Platform environments with DLP connector policies customized to suit the user's needs while also maintaining the agency's security posture.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERPLATFORM.2.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerplatform"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "178e889d-315e-440f-ba4e-cb73f8b666c8",
        "title" : "Non-default environments SHOULD have at least one DLP policy affecting them.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform22v1"
        }, {
          "text" : "T1567: Exfiltration Over Web Service",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1567/"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.2v1"
          } ],
          "description" : "Repeat steps 1 to 11 in the MS.POWERPLATFORM.2.1v1 instructions.",
          "uuid" : "b8d7e068-3091-4afc-b154-4b584a2af16f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.2v1"
          } ],
          "description" : "At the **Scope** section for the default environment, select **Add multiple environments** and select the non-default environments where you wish to enforce a DLP policy upon. If you wish to apply the DLP policy for all environments including environments created in the future select **Add all environments**.",
          "uuid" : "a9aef7d5-9d2a-436a-bb7a-13baf4f4b21f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.2.2v1"
          } ],
          "description" : "Select **Next** -\\> **Create Policy** to finish.",
          "uuid" : "4e446aab-67c4-4431-8f80-9dbdfd0fe335"
        } ],
        "description" : "Users may inadvertently use connectors that share sensitive information with others who should not have access to it. DLP policies provide a way for agencies to detect and prevent unauthorized disclosures.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERPLATFORM.2.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerplatform"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "dca1492f-a75d-4a5a-b011-0877fbc6d049",
        "title" : "Power Platform tenant isolation SHALL be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform31v1"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.004: Cloud Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/004/"
        }, {
          "text" : "T1190: Exploit Public-Facing Application",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1190/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.3.1v1"
          } ],
          "description" : "Sign in to your tenant environment's respective [Power Platform admin center](https://learn.microsoft.com/en-us/power-platform/admin/powerapps-us-government#power-apps-us-government-service-urls).",
          "uuid" : "ccb7ebc5-3648-466f-bea5-4d2ecff6d0e5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.3.1v1"
          } ],
          "description" : "On the left pane, select **Policies -\\> Tenant Isolation**.",
          "uuid" : "e2053137-68ba-410d-8fdf-c8b9e6738f8e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.3.1v1"
          } ],
          "description" : "Set the slider in the center of the screen to **On** then click **Save** on the bottom of the screen.",
          "uuid" : "b2ff7170-e416-472e-9386-5559e7f673c1"
        } ],
        "description" : "Provides an additional tenant isolation control on top of Microsoft Entra ID tenant isolation specifically for Power Platform applications to prevent accidental or malicious cross tenant information sharing.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERPLATFORM.3.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerplatform"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "sc-7.5",
              "statement-ids" : [ "sc-7.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "73303e8b-4915-4aba-afe1-184171c863ab",
        "title" : "An inbound/outbound connection allowlist SHOULD be configured.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/powerplatform.md#mspowerplatform32v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.3.2v1"
          } ],
          "description" : "Follow steps **1 and 2** in **MS.POWERPLATFORM.3.1v1 instructions** to arrive at the same page.",
          "uuid" : "2b2955f4-21e1-411d-9e85-13e3bfc02526"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.3.2v1"
          } ],
          "description" : "The tenant isolation allowlist can be configured by clicking **New tenant rule** on the Tenant Isolation page.",
          "uuid" : "7e0d112b-304c-40ce-8df4-b20c0cc8f342"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.3.2v1"
          } ],
          "description" : "Select the **Direction** of the rule and add the **Tenant Domain or ID** this rule applies to.",
          "uuid" : "4a8f9864-8e25-4864-a78a-8abf5de12f6c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.POWERPLATFORM.3.2v1"
          } ],
          "description" : "If Tenant Isolation is switched **Off** , these rules will not be enforced until tenant isolation is turned **On**.",
          "uuid" : "5101377d-ffdb-413c-b8fa-2dd54fa1e990"
        } ],
        "description" : "Depending on agency needs an allowlist can be configured to allow cross tenant collaboration via connectors.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.POWERPLATFORM.3.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "powerplatform"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "sc-7.5",
              "statement-ids" : [ "sc-7.5_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "522bf49f-40ef-467a-ae7b-e1454d25e099",
        "title" : "External sharing for SharePoint SHALL be limited to Existing guests or Only people in your organization.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint11v1"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.1v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "87b4647e-216e-433b-b94e-6822caaf3f44"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.1v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**.",
          "uuid" : "e63f5294-6c42-4874-b6f5-f9cdbe0099d2"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.1v1"
          } ],
          "description" : "Adjust external sharing slider for SharePoint to **Existing guests** or **Only people in your organization**.",
          "uuid" : "3fe2c8de-259e-42aa-b890-5753539b6bb4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.1v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "37529765-8dd3-462b-886b-ce5035ba7253"
        } ],
        "description" : "Sharing information outside the organization via SharePoint increases the risk of unauthorized access. By limiting external sharing, administrators decrease the risk of access to information.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.1.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2",
              "statement-ids" : [ "ac-2_smt" ]
            }, {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "ia-8",
              "statement-ids" : [ "ia-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "def51a1f-d3a1-4828-a668-3d65de030452",
        "title" : "External sharing for OneDrive SHALL be limited to Existing guests or Only people in your organization.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint12v1"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.2v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "0f33e719-b721-4848-8cc2-a57443d771c9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.2v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**.",
          "uuid" : "2d577237-8320-43e1-96e9-22c42f47a0fe"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.2v1"
          } ],
          "description" : "Adjust external sharing slider for OneDrive to **Existing Guests** or **Only people in your organization**.",
          "uuid" : "99f2ea63-174d-4c46-b39e-b435e3b98c13"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.2v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "95b79bc4-a2db-46e6-9092-a592b35f1a1a"
        } ],
        "description" : "Sharing files outside the organization via OneDrive increases the risk of unauthorized access. By limiting external sharing, administrators decrease the risk of unauthorized access to information.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.1.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-2",
              "statement-ids" : [ "ac-2_smt" ]
            }, {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "ia-8",
              "statement-ids" : [ "ia-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "3eb09e37-f0d1-421e-aae0-4bba554804d0",
        "title" : "External sharing SHALL be restricted to approved external domains and/or users in approved security groups per interagency collaboration needs.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint13v1"
        }, {
          "text" : "Overview of external sharing in SharePoint and OneDrive in Microsoft 365 \\\\\\| Microsoft Documents",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/sharepoint/external-sharing-overview"
        }, {
          "text" : "Manage sharing settings for SharePoint and OneDrive in Microsoft 365 \\\\\\| Microsoft Documents",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/sharepoint/turn-external-sharing-on-or-off"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Note: If SharePoint external sharing is set to its most restrictive setting of \"Only people in your organization\", then no external sharing is allowed and no implementation changes are required for this policy item.",
          "uuid" : "589e7e08-056a-46e2-922a-098f025ee20b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "ef873032-9e6d-4ad8-84e4-d0f7caf8f648"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**.",
          "uuid" : "d5846a22-c712-45b8-b9bc-6b74037893df"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Expand **More external sharing settings**.",
          "uuid" : "fef647e1-80e9-488d-9508-ec8a657613e5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Select **Limit external sharing by domain**.",
          "uuid" : "68c7893c-cb6d-4433-b4fe-c567d6e490e2"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Select **Add domains**.",
          "uuid" : "53510845-eb88-47fc-9dab-56e8f5a4600d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Add each approved external domain users are allowed to share files with.",
          "uuid" : "7c1c36c0-cd8b-447a-89f5-02cf629a6bf8"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Select **Manage security groups**",
          "uuid" : "602f1a97-589f-44a1-8b61-e381238e2ee1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Add each approved security group. Members of these groups will be allowed to share files externally.",
          "uuid" : "7ef87fa7-2a3f-4c58-a402-9b707827b06b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.1.3v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "d2a52c59-4d5f-40d2-ae4c-98cb021f0451"
        } ],
        "description" : "By limiting sharing to domains or approved security groups used for interagency collaboration purposes, administrators can help prevent sharing with unknown organizations and individuals.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.1.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "ac-6.10",
              "statement-ids" : [ "ac-6.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "584a173c-3bbb-40c9-a49a-10f6f543c444",
        "title" : "File and folder default sharing scope SHALL be set to Specific people (only the people the user specifies).",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint21v1"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1565.001: Stored Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.1v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "3f7ce038-de74-4ac0-bd9d-447e0f83c82a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.1v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**",
          "uuid" : "ca4728d4-0a04-4935-9a5d-b9d11f60b189"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.1v1"
          } ],
          "description" : "Under **File and folder links** , set the default link type to **Specific people (only the people the user specifies)**",
          "uuid" : "0c109acb-c788-4d1d-a6be-b655290ebbaf"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.1v1"
          } ],
          "description" : "Select **Save**",
          "uuid" : "5d373712-bec4-4120-8f7b-58a0da5d8ac4"
        } ],
        "description" : "By making the default sharing the most restrictive, administrators prevent accidentally sharing information too broadly.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.2.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6",
              "statement-ids" : [ "ac-6_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "8a7c5308-54a8-4328-acce-c501ff2f5697",
        "title" : "File and folder default sharing permissions SHALL be set to View.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint22v1"
        }, {
          "text" : "T1080: Taint Shared Content",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1080/"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1565.001: Stored Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.2v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "d98df506-fac0-4774-b696-90918f1e54ba"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.2v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**.",
          "uuid" : "f03b3e66-e5ee-41c4-bb87-36bd2a793bc8"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.2v1"
          } ],
          "description" : "Under **File and folder links** , set the permission that is selected by default for sharing links to **View**.",
          "uuid" : "12d5dc6d-ef7a-4b2b-b46c-c3385b7dd68e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.2.2v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "0fc3fa6c-3c8a-4084-98cb-6395365d9a51"
        } ],
        "description" : "Edit access to files and folders could allow a user to make unauthorized changes. By restricting default permissions to **View**, administrators prevent unintended or malicious modification.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.2.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6",
              "statement-ids" : [ "ac-6_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "b59613d0-9937-49f3-93a5-853ae8490b07",
        "title" : "Expiration days for Anyone links SHALL be set to 30 days or less.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint31v1"
        }, {
          "text" : "T1048: Exfiltration Over Alternative Protocol",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1048/"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1213.002: Sharepoint",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/002/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.1v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "33115e2c-0499-443c-8d5f-f36ee2b49bbd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.1v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**.",
          "uuid" : "d3c3d427-b37d-474b-898a-83cb6c235d5b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.1v1"
          } ],
          "description" : "Scroll to the section **Choose expiration and permissions options for Anyone links**.",
          "uuid" : "5fbdb353-4135-4682-97da-42fd8ec03edd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.1v1"
          } ],
          "description" : "Select the checkbox **These links must expire within this many days**.",
          "uuid" : "0c7a8429-13d9-4afb-81f5-4bf89fc33034"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.1v1"
          } ],
          "description" : "Enter **30** days or less.",
          "uuid" : "9a8aa4a9-b1ec-4e80-945f-8374830917a2"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.1v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "8307f715-76cb-4d21-9dc1-6ec8f56d0999"
        } ],
        "description" : "Links may be used to provide access to information for a short period of time. Without expiration, however, access is indefinite. By setting expiration timers for links, administrators can prevent unintended sustained access to the link.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.3.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            }, {
              "control-id" : "ac-21",
              "statement-ids" : [ "ac-21_smt.b" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "b45c4e08-08b1-418a-973a-7b41df26b859",
        "title" : "The allowable file and folder permissions for links SHALL be set to View only.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint32v1"
        }, {
          "text" : "T1080: Taint Shared Content",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1080/"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1565.001: Stored Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.2v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "000fc5be-cc16-4a7b-bc16-c3aeae33e103"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.2v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**.",
          "uuid" : "a5835d1e-c530-4b40-be4a-5832a6c5de77"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.2v1"
          } ],
          "description" : "Scroll to the section **Choose expiration and permissions options for Anyone links**.",
          "uuid" : "fb25a9e4-2b81-45e5-8487-e8ee5ad2e838"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.2v1"
          } ],
          "description" : "Set the configuration items in the section **These links can give these permissions**.",
          "uuid" : "05ebcb00-e217-4756-91bb-7cb279e44d8a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.2v1"
          } ],
          "description" : "Set the **Files** option to **View**.",
          "uuid" : "fa7be0ee-20e3-4e5f-a4a0-f19f7f91e94d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.2v1"
          } ],
          "description" : "Set the **Folders** option to **View**.",
          "uuid" : "9b023161-f24b-4b35-9ccc-1d0d9502a0fb"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.2v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "c4a71a69-cb93-4023-87a0-3824291a541e"
        } ],
        "description" : "Unauthorized changes to files can be made if permissions allow editing by anyone. By restricting permissions on links to **View** only, administrators prevent anonymous file changes.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.3.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-6",
              "statement-ids" : [ "ac-6_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "a18c86d3-e669-4335-a8b2-73251ca53d6a",
        "title" : "Reauthentication days for people who use a verification code SHALL be set to 30 days or less.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/sharepoint.md#mssharepoint33v1"
        }, {
          "text" : "T1080: Taint Shared Content",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1080/"
        }, {
          "text" : "T1565: Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/"
        }, {
          "text" : "T1565.001: Stored Data Manipulation",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1565/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.3v1"
          } ],
          "description" : "Sign in to the **SharePoint admin center**.",
          "uuid" : "1e7207a4-6b26-4464-af2a-0bf3c6d50342"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.3v1"
          } ],
          "description" : "Select **Policies** \\> **Sharing**.",
          "uuid" : "cfeb871f-51a9-4d79-a3c1-b96b29c39c03"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.3v1"
          } ],
          "description" : "Expand **More external sharing settings**.",
          "uuid" : "b22efa72-e875-40bf-9f76-4daf0f896a0f"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.3v1"
          } ],
          "description" : "Select **People who use a verification code must reauthenticate after this many days**.",
          "uuid" : "6f2864b8-a7a3-48a3-acd9-e83c751ae934"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.3v1"
          } ],
          "description" : "Enter **30** days or less.",
          "uuid" : "0ed1bada-21d2-415e-bf08-30e7a083ea5d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.SHAREPOINT.3.3v1"
          } ],
          "description" : "Select **Save**.\n\n**`TLP:CLEAR`**",
          "uuid" : "4c861d1d-4b04-4fc5-961d-ea69b0448131"
        } ],
        "description" : "A verification code may be issued to provide access to information for a short period. By setting expiration timers for verification code access, administrators can prevent unintended sustained access to documents.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.SHAREPOINT.3.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "sharepoint"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ia-11",
              "statement-ids" : [ "ia-11_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "8f9b0032-a08a-41c1-a5e2-64859e0a19ce",
        "title" : "External meeting participants SHOULD NOT be enabled to request control of shared desktops or windows.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams11v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.1v1"
          } ],
          "description" : "To help ensure external participants do not have the ability to request control of the shared desktop or window in the meeting:",
          "uuid" : "3d8a60c8-327e-49d2-b8aa-22a636b0accc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.1v1"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "c01b4f24-07d8-42f1-93eb-957a6ad0d371"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.1v1"
          } ],
          "description" : "Select **Meetings** \\> **Meeting policies**.",
          "uuid" : "1c77c6d8-17e1-452c-a8cf-793b27f61d1e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.1v1"
          } ],
          "description" : "Select the **Global (Org-wide default)** policy.",
          "uuid" : "c86f7eff-f2ff-4aac-8e0d-e9ec235e10fa"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.1v1"
          } ],
          "description" : "Under the **Content sharing** section, set **External participants can give or request control** to **Off**.",
          "uuid" : "413ff8c1-9e1c-4389-bd7f-58eef45a5420"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.1v1"
          } ],
          "description" : "If custom policies were created, repeat these steps for each policy, selecting the appropriate policy in step 3.",
          "uuid" : "20a8d31e-17bb-4188-ba73-2a1b5a626406"
        } ],
        "description" : "An external participant with control of a shared screen could potentially perform unauthorized actions on the shared screen. This policy reduces that risk by removing an external participant's ability to request control. However, if an agency has a legitimate use case to grant this control, it may be done on a case-by-case basis.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.1.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-17",
              "statement-ids" : [ "ac-17_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "bf03a548-3428-4d6b-ace3-d1b01227d01b",
        "title" : "Anonymous users SHALL NOT be enabled to start meetings.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams12v2"
        }, {
          "text" : "T1078: Valid Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/"
        }, {
          "text" : "T1078.001: Default Accounts",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1078/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.2v2"
          } ],
          "description" : "To configure settings for anonymous users:",
          "uuid" : "88b10ee6-d463-4983-88e6-7a593dfe7e0a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.2v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "ca86f836-8470-4ff9-9556-290e89b0a31c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.2v2"
          } ],
          "description" : "Select **Meetings** \\> **Meeting policies**.",
          "uuid" : "38c46d44-62b2-4e0c-a5ec-2f9dba70a4f1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.2v2"
          } ],
          "description" : "Select the **Global (Org-wide default)** policy.",
          "uuid" : "1b69fe4e-82ca-443d-aa92-d944ab7a10d9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.2v2"
          } ],
          "description" : "Under the **Meeting join \\& lobby** section, ensure the **Anonymous users and dial-in callers can start a meeting** setting remains at the default position of **Off**.",
          "uuid" : "c59dbbbc-125c-42ff-bd0f-c2e07a405dc6"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.2v2"
          } ],
          "description" : "If custom policies were created, repeat these steps for each policy, selecting the appropriate policy in step 3.",
          "uuid" : "ca07798d-4726-440f-87c2-24b7b6a523fd"
        } ],
        "description" : "For agencies that implemented custom policies providing more flexibility to some users to automatically admit \"everyone\" to a meeting - this policy provides protection from anonymous users starting meeting to scrape internal contacts.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.1.2v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-15",
              "statement-ids" : [ "sc-15_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "963a5942-d555-4a3a-9a37-701d8a72c957",
        "title" : "Anonymous users and dial-in callers SHOULD NOT be admitted automatically.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams13v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.3v1"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "194d863d-5a6f-4963-8bb1-03c837f72ac8"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.3v1"
          } ],
          "description" : "Select **Meetings** \\> **Meeting policies**.",
          "uuid" : "07c0be5f-0478-4bd2-bede-c52f57c9a0b3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.3v1"
          } ],
          "description" : "Select the **Global (Org-wide default)** policy.",
          "uuid" : "abbfe197-ccfe-400e-8dd1-ff09909dffc0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.3v1"
          } ],
          "description" : "Under the **Meeting join \\& lobby** section, ensure **Who can bypass the lobby** is **not** set to **Everyone** . Bypassing the lobby should be set to **People in my org**, though other options may be used if needed.",
          "uuid" : "b2e5efab-8ced-4e1b-bbc3-eada47b57743"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.3v1"
          } ],
          "description" : "In the same section, set **People dialing in can bypass the lobby** to **Off**.",
          "uuid" : "4f6fe88c-5a24-4030-8d39-123932d10e90"
        } ],
        "description" : "Automatically allowing admittance to anonymous and dial-in users diminishes control of meeting participation and invites potential data breach. This policy reduces that risk by requiring all anonymous and dial-in users to wait in a lobby until admitted by an authorized meeting participant. If the agency has a use case to admit members of specific trusted organizations and/or B2B guests automatically, custom policies may be created and assigned to authorized meeting organizers.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.1.3v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-15",
              "statement-ids" : [ "sc-15_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "db3c237a-c45e-456c-b257-a7c16da77305",
        "title" : "Internal users SHOULD be admitted automatically.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams14v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.4v1"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "1c76ee77-ef01-42bb-8567-bb1dcf6d61ac"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.4v1"
          } ],
          "description" : "Select **Meetings** \\> **Meeting policies**.",
          "uuid" : "135adb0e-d8b4-4133-a54f-073def7b1f27"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.4v1"
          } ],
          "description" : "Select the **Global (Org-wide default)** policy.",
          "uuid" : "d1df0859-06ab-45e0-86b9-fa64968b6535"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.4v1"
          } ],
          "description" : "Under the **Meeting join \\& lobby** section, ensure **Who can bypass the lobby** is set to **People in my org**.",
          "uuid" : "02ce4bad-ba8b-443d-a19e-ecb1e15507ac"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.4v1"
          } ],
          "description" : "In the same section, set **People dialing in can bypass the lobby** to **Off**.",
          "uuid" : "e7dfd02b-a7fb-4bcb-9dee-3446cc638b72"
        } ],
        "description" : "Requiring internal users to wait in the lobby for explicit admission can lead to admission fatigue. This policy enables internal users to be automatically admitted to the meeting through global policy.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.1.4v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "4f00ab73-cac4-4c62-b29b-9111a4ed93d9",
        "title" : "Dial-in users SHOULD NOT be enabled to bypass the lobby.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams15v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.5v1"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "db280df1-5cde-4671-aa8b-522f5957f892"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.5v1"
          } ],
          "description" : "Select **Meetings** \\> **Meeting policies**.",
          "uuid" : "474de845-60ac-4970-a289-a12bbb18286c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.5v1"
          } ],
          "description" : "Select the **Global (Org-wide default)** policy.",
          "uuid" : "935d6a55-6fa9-41b7-8545-8dd862f0cf36"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.5v1"
          } ],
          "description" : "Under the **Meeting join \\& lobby** section, set **People dialing in can bypass the lobby** to **Off**.",
          "uuid" : "2ef8d93a-e486-4b8d-9d04-d5c77e6d7fe5"
        } ],
        "description" : "Automatically admitting dial-in users reduces control over who can participate in a meeting and increases potential for data breaches. This policy reduces the risk by requiring all dial-in users to wait in a lobby until they are admitted by an authorized meeting participant.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.1.5v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-15",
              "statement-ids" : [ "sc-15_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "84aaa8de-a447-4b8b-9a91-d22fad2fd137",
        "title" : "Meeting recording SHOULD be disabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams16v1"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.6v1"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "d4848d72-be66-4195-a1c3-d3f449990b0e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.6v1"
          } ],
          "description" : "Select **Meetings** \\> **Meeting policies**.",
          "uuid" : "1510fd9b-2e04-40b1-a26f-b745897271fd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.6v1"
          } ],
          "description" : "Select the **Global (Org-wide default)** policy.",
          "uuid" : "d89ff99f-50c9-452e-9f01-7dc8306ac9a0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.6v1"
          } ],
          "description" : "Under the **Recording \\& transcription** section, set **Meeting recording** to **Off**.",
          "uuid" : "cbdfd38b-139a-4ade-b0a8-e638ad17dade"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.6v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "3d2a37c9-d284-46e8-b269-0351490a719e"
        } ],
        "description" : "Allowing any user to record a Teams meeting or group call may lead to unauthorized disclosure of shared information, including audio, video, and shared screens. By disabling the meeting recording setting in the Global (Org-wide default) meeting policy, an agency limits information exposure.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.1.6v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "44746bb7-54e9-4ec9-ac84-958cee288130",
        "title" : "Record an event SHOULD NOT be set to Always record.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams17v2"
        }, {
          "text" : "Meeting policy settings \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoftteams/settings-policies-reference#meetings"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.7v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "aa1bcfbc-352d-4dd1-b727-91db172b34c0"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.7v2"
          } ],
          "description" : "Select **Meetings** \\> **Live events policies**.",
          "uuid" : "531fe24f-52ff-4bb9-8014-3be09b5d6ce9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.7v2"
          } ],
          "description" : "Select **Global (Org-wide default)** policy.",
          "uuid" : "150019ff-de35-4f9b-a682-3e6429c1d3c4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.7v2"
          } ],
          "description" : "Set **Record an event** to either **Organizer can record** or **Never record**",
          "uuid" : "5f79ce3a-0c12-4ca1-bb01-dcbd1f490b7a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.7v2"
          } ],
          "description" : "Click **Save**.",
          "uuid" : "f30e383f-2e2b-4aeb-934f-760132d4d934"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.1.7v2"
          } ],
          "description" : "If custom policies were created, repeat these steps for each policy, selecting the appropriate policy in step 3.",
          "uuid" : "7e1b42bb-c8b1-4a2f-aef0-592df3fa23e4"
        } ],
        "description" : "Allowing to always record Live Events can pose data and video recording leakage and other security risks. Limiting recording permissions to only the organizer minimizes the security risk to the organizer's discretion for these Live Events. Administrators can also disable recording for all live events.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.1.7v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-21",
              "statement-ids" : [ "ac-21_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "076dd740-6295-4a40-a94e-2d79420c8f88",
        "title" : "External access for users SHALL only be enabled on a per-domain basis.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams21v2"
        }, {
          "text" : "T1199: Trusted Relationship",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1199/"
        }, {
          "text" : "T1204: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.001: Malicious Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.1v2"
          } ],
          "description" : "To enable external access for only specific domains:",
          "uuid" : "766ba25c-be2f-4133-ba13-dc534d7286b5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.1v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "38b5757b-c3a2-4fd4-9157-7e4fa2583571"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.1v2"
          } ],
          "description" : "Select **Users** \\> **External access** \\> **Organization settings**.",
          "uuid" : "1e8a984b-c568-4a38-94c9-3b8ea0bcf248"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.1v2"
          } ],
          "description" : "Next to **Teams and Skype for Business users in external organizations** , select **Allow only specific external domains**",
          "uuid" : "97dd64b5-46c2-4aea-b946-130bd224920d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.1v2"
          } ],
          "description" : "Select **Add external domains** . Enter domains allowed, and then select **Done**\n\n    **NOTE:** Domains will need to be added in this step in order for users to communicate with them.",
          "uuid" : "2aa997a0-be7b-4038-9088-3d2122c2ebd5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.1v2"
          } ],
          "description" : "Click **Save**.",
          "uuid" : "7f1911bb-e928-458b-9c44-fc2db5c94a9a"
        } ],
        "description" : "The default configuration allows members to communicate with all external users with similar access permissions. This unrestricted access can lead to data breaches and other security threats. This policy provides protection against threats posed by unrestricted access by allowing communication with only trusted domains.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.2.1v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "ac-3",
              "statement-ids" : [ "ac-3_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "fa87e4e6-7d39-48a9-82a3-bbd0925b9cd8",
        "title" : "Unmanaged users SHALL NOT be enabled to initiate contact with internal users.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams22v2"
        }, {
          "text" : "T1204: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.001: Malicious Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.2v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "3c3273a8-d282-41e9-833f-f1cf64f792ed"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.2v2"
          } ],
          "description" : "Select **Users \\> External access**.",
          "uuid" : "d57a764e-92b2-47db-8373-abb999a900a1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.2v2"
          } ],
          "description" : "Select **Policies**.",
          "uuid" : "e523e135-17bb-4482-90db-55f24a31fd27"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.2v2"
          } ],
          "description" : "Select **Global (Org-wide Default)**.",
          "uuid" : "e06059c8-857c-43a2-8da3-747ced7ad3ff"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.2v2"
          } ],
          "description" : "Under **Edit policy details** , toggle **People in my organization can communicate with unmanaged Teams accounts** to one of the following: 1. To completely block contact with unmanaged users, toggle the setting to **Off** . 2. To allow contact with unmanaged users only if the internal user initiates the contact: - Toggle the setting to **On** . - Clear the check next to **External users with Teams accounts not managed by an organization can contact users in my organization**.",
          "uuid" : "2e356802-f0c3-4a7f-a443-68a8428e831d"
        } ],
        "description" : "Allowing contact from unmanaged users can expose users to email and contact address harvesting. This policy provides protection against this type of harvesting.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.2.2v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            }, {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "226db579-62a9-4b65-89e8-63e94e4ddd3e",
        "title" : "Internal users SHOULD NOT be enabled to initiate contact with unmanaged users.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams23v2"
        }, {
          "text" : "T1204: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.001: Malicious Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.3v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "e8335bc1-9ec3-4bea-adee-7b50535da4c5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.3v2"
          } ],
          "description" : "Select **Users \\> External access**.",
          "uuid" : "762059e4-39fc-49e0-b70e-e6370a76d03d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.3v2"
          } ],
          "description" : "Select **Policies**.",
          "uuid" : "efa02362-5cdd-4cd7-b874-2b1a4e4d528a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.3v2"
          } ],
          "description" : "Select **Global (Org-wide Default)**.",
          "uuid" : "479f790c-69fb-45f1-b894-bb7562b1b9cc"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.2.3v2"
          } ],
          "description" : "To completely block contact with unmanaged users, under **Edit policy details** , set **People in my organization can communicate with unmanaged Teams accounts** to **Off**.",
          "uuid" : "d910834b-f715-435c-a6da-636ee2897a19"
        } ],
        "description" : "Contact with unmanaged users can pose the risk of data leakage and other security threats. This policy provides protection by disabling internal user access to unmanaged users.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.2.3v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-7",
              "statement-ids" : [ "cm-7_smt" ]
            }, {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "5474bd7e-30f4-4a40-a97e-a72818bb8e3e",
        "title" : "Teams email integration SHALL be disabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams41v1"
        }, {
          "text" : "T1204: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.001: Malicious Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/001/"
        }, {
          "text" : "T1204.002: Malicious File",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.4.1v1"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "6d10c9ad-5233-433a-8d75-024e012865f4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.4.1v1"
          } ],
          "description" : "Select **Teams** \\> **Teams Settings**.",
          "uuid" : "62e34bb8-ec8b-460b-a3e1-14d55bd2d0de"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.4.1v1"
          } ],
          "description" : "Under the **Email integration** section, set **Users can send emails to a channel email address** to **Off**.",
          "uuid" : "22e860b3-408e-44f9-97d3-ff531da4dcfa"
        } ],
        "description" : "Microsoft Teams email integration associates a Microsoft, not tenant domain, email address with a Teams channel. Channel emails are addressed using the Microsoft-owned domain `<teams.ms>`. By disabling Teams email integration, an agency prevents potentially sensitive Teams messages from being sent through external email gateways.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.4.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-8",
              "statement-ids" : [ "si-8_smt" ]
            }, {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt.a" ]
            }, {
              "control-id" : "ac-4",
              "statement-ids" : [ "ac-4_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "471a3743-1240-4604-a0b2-5e927c677ff6",
        "title" : "Agencies SHOULD only allow installation of Microsoft apps approved by the agency.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams51v2"
        }, {
          "text" : "T1195: Supply Chain Compromise",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1195/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "b09210ac-64cc-40a8-814f-5a7da9c7d434"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Select **Teams apps** \\> **Manage apps**.",
          "uuid" : "a2ba06ff-0d53-41ad-819f-a5f32e8adccd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "In the upper right-hand corner select **Actions**",
          "uuid" : "41025e52-065b-486f-8ad6-9bc5299ea4f2"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Select **Org-wide app settings**.",
          "uuid" : "b49869ad-1aa4-4030-bc93-9b8555548723"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Under **Microsoft apps** \\> Select **On**",
          "uuid" : "3a68d0fd-4860-42a6-a71f-236fad34f11d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Click **Save**.\n\n    **NOTE:** This will make Microsoft apps in the application list available to \"Everyone.\" If adjustments are needed follow the remaining instructions",
          "uuid" : "aa0c1df1-5f40-4c19-bb24-2159f45c7b99"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Select **Teams apps** \\> **Manage apps**.",
          "uuid" : "804f894a-37d2-48e1-9d4f-27c09af6be58"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Select each individual app.",
          "uuid" : "d42c0612-5196-4065-a3e8-c57a60c18cac"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Select **Users and groups** \\> **Edit availability**",
          "uuid" : "daf1dc29-0b01-4cf0-8012-3b9c20212d5d"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Change **Available to** to the appropriate setting for your organization. (Everyone, Specific users or groups, or No one)",
          "uuid" : "995ddec7-3878-4a65-a73b-e895142b3b18"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.1v2"
          } ],
          "description" : "Repeat steps 7 to 10 for each application",
          "uuid" : "7038c3ac-7f9a-4626-91f2-445dbf93d8fe"
        } ],
        "description" : "Allowing Teams integration with all Microsoft apps can expose the agency to potential vulnerabilities present in those apps. By only allowing specific apps and blocking all others, the agency will better manage its app integration and potential exposure points.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.5.1v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-11",
              "statement-ids" : [ "cm-11_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "87f16e5f-689f-4d2c-8976-a0085284775f",
        "title" : "Agencies SHOULD only allow installation of third-party apps approved by the agency.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams52v2"
        }, {
          "text" : "T1195: Supply Chain Compromise",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1195/"
        }, {
          "text" : "T1528: Steal Application Access Token",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1528/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "9cbffe74-b772-48d7-86d4-2eae4e97439b"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Select **Teams apps** \\> **Manage apps**.\n\n1. In the upper right-hand corner select **Actions**",
          "uuid" : "d4d40b0c-9c50-4ad2-b343-06ceb375a45a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Select **Org-wide app settings**.",
          "uuid" : "2790e8eb-44bd-4fef-a7fc-896643f46fb9"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Under **Third-party apps** \\> Select **Off**",
          "uuid" : "81431103-8cca-4138-b02b-8a946edabbb7"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Click **Save**.\n\n    **NOTE:** This will make third party apps in the application list available to \"No one.\" If adjustments are needed follow the remaining                     instructions\n\n1. Select **Teams apps** \\> **Manage apps**.",
          "uuid" : "45b6683f-01af-4595-b4ff-512bc03c067a"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Select each individual app.",
          "uuid" : "84502446-2335-4f29-8a61-6ea69341b32c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Select **Users and groups** \\> **Edit availability**",
          "uuid" : "aca3dae9-5d71-49a5-ba07-0b1b09deeff3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Change **Available to** to the appropriate setting for your organization. (Everyone, Specific users or groups, or No one)",
          "uuid" : "b9a9c571-6d1d-49b0-9f10-16dc006a4052"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.2v2"
          } ],
          "description" : "Repeat steps 7 to 10 for each application",
          "uuid" : "d2f1f643-5af6-4eed-b7db-ccfa18c434e6"
        } ],
        "description" : "Allowing Teams integration with third-party apps can expose the agency to potential vulnerabilities present in an app not managed by the agency. By allowing only specific apps approved by the agency and blocking all others, the agency can limit its exposure to third-party app vulnerabilities.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.5.2v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-11",
              "statement-ids" : [ "cm-11_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "4dd5ba31-a92c-4ab7-abd0-cee445580cb9",
        "title" : "Agencies SHOULD only allow installation of custom apps approved by the agency.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams53v2"
        }, {
          "text" : "Use app permission policies to control user access to apps \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoftteams/teams-app-permission-policies"
        }, {
          "text" : "Upload your app in Microsoft Teams \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoftteams/platform/concepts/deploy-and-publish/apps-upload"
        }, {
          "text" : "T1195: Supply Chain Compromise",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1195/"
        }, {
          "text" : "T1528: Steal Application Access Token",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1528/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "5500712e-61f3-4026-bfbb-08c9966956c1"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Select **Teams apps** \\> **Manage apps**.\n\n1. In the upper right-hand corner select **Actions**",
          "uuid" : "5875fb1c-6452-4e16-b26a-1b3f87f499f8"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Select **Org-wide app settings**.",
          "uuid" : "598e3d9e-84d4-423d-99f6-f4e542be6ac3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Under **Custom apps** \\> Select **Off**",
          "uuid" : "c0b52984-5c92-4fd2-9b10-bef6e1b48bd3"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Click **Save**.\n\n    **NOTE:** This will make Custom apps in the application list available to \"No one.\" If adjustments are needed follow the remaining                     instructions\n\n1. Select **Teams apps** \\> **Manage apps**.",
          "uuid" : "cdd77261-f66b-4a96-ae12-8ecae94ec813"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Select each individual app.",
          "uuid" : "015cfc20-9a61-498f-8160-92aecb5b23cd"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Select **Users and groups** \\> **Edit availability**",
          "uuid" : "d2beb8aa-eec0-4967-9c36-e64bcc6cf30e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Change **Available to** to the appropriate setting for your organization. (Everyone, Specific users or groups, or No one)",
          "uuid" : "5eb502b1-c48e-4c86-bee3-64df17e70930"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.5.3v2"
          } ],
          "description" : "Repeat steps 7 to 10 for each application",
          "uuid" : "e5946574-090d-4fc3-b173-e0259451a08f"
        } ],
        "description" : "Allowing custom apps integration can expose the agency to potential vulnerabilities present in an app not managed by the agency. By allowing only specific apps approved by the agency and blocking all others, the agency can limit its exposure to custom app vulnerabilities.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.5.3v2"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "cm-11",
              "statement-ids" : [ "cm-11_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "942d88b3-7f15-45df-86b5-af1f4c55d454",
        "title" : "A DLP solution SHALL be enabled. The selected DLP solution SHOULD offer services comparable to the native DLP solution offered by Microsoft.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams61v1"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.6.1v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [DLP](./defender.md#implementation-3) for additional guidance.",
          "uuid" : "eae2ac50-e6b0-4b1b-b062-83fc82cc9588"
        } ],
        "description" : "Teams users may inadvertently disclose sensitive information to unauthorized individuals. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized disclosures.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.6.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "07eb006e-f1f6-4fb1-978f-e70ebcec158a",
        "title" : "The DLP solution SHALL protect personally identifiable information (PII)",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams62v1"
        }, {
          "text" : "Plan for data loss prevention (DLP) \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/compliance/dlp-overview-plan-for-dlp?view=o365-worldwide"
        }, {
          "text" : "T1213: Data from Information Repositories",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1213/"
        }, {
          "text" : "T1530: Data from Cloud Storage",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1530/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.6.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [DLP](./defender.md#implementation-3) for additional guidance.",
          "uuid" : "2ea2fd18-3d81-47f3-8681-0c614ced1141"
        } ],
        "description" : "Teams users may inadvertently share sensitive information with others who should not have access to it. Data loss prevention policies provide a way for agencies to detect and prevent unauthorized sharing of sensitive information.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.6.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHALL"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "sc-7.10",
              "statement-ids" : [ "sc-7.10_smt" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "ab95ca9f-6d00-4ed3-b998-3ff83155298b",
        "title" : "Attachments included with Teams messages SHOULD be scanned for malware.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams71v1"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.7.1v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [Safe Attachments](./defender.md#implementation-2) for additional guidance.",
          "uuid" : "051f436a-b3aa-46b4-998e-afcd2c1f2c6f"
        } ],
        "description" : "Teams can be used as a mechanism for delivering malware. In many cases, malware can be detected through scanning, reducing the risk for end users.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.7.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "9e47b07b-ef09-4922-a0a7-07a6fc1e2cc7",
        "title" : "Users SHOULD be prevented from opening or downloading files detected as malware.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams72v1"
        }, {
          "text" : "T1204: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.002: Malicious File",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/002/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.7.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [Safe Attachments](./defender.md#implementation-2) for additional guidance.",
          "uuid" : "1062b4bc-27f6-496f-a070-a61f74d09280"
        } ],
        "description" : "Teams can be used as a mechanism for delivering malware. In many cases, malware can be detected through scanning, reducing the risk for end users.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.7.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "9938d3df-3547-4cc7-9e2b-ebc2f0c91264",
        "title" : "URL comparison with a blocklist SHOULD be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams81v1"
        }, {
          "text" : "T1204: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.001: Malicious Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/001/"
        }, {
          "text" : "T1204.002: Malicious File",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/002/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1189: Drive-by Compromise",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1189/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.1v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [standard or strict preset security policy](defender.md#msdefender13v1-instructions) for additional guidance.",
          "uuid" : "234aa3f2-12dc-48c6-a7d3-473fc901a504"
        } ],
        "description" : "Users may be directed to malicious websites via links in Teams. Blocking access to known malicious URLs can help prevent users from accessing known malicious websites.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.8.1v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "si-3",
              "statement-ids" : [ "si-3_smt.a" ]
            } ]
          } ]
        }
      }, {
        "uuid" : "701bb223-b84b-4877-8ce5-1c3801131aa2",
        "title" : "User click tracking SHOULD be enabled.",
        "links" : [ {
          "rel" : "canonical",
          "href" : "https://github.com/cisagov/ScubaGear/tree/main/PowerShell/ScubaGear/baselines/teams.md#msteams82v1"
        }, {
          "text" : "Set up Safe Links policies in Microsoft Defender for Office 365 \\\\\\| Microsoft Learn",
          "rel" : "reference",
          "href" : "https://learn.microsoft.com/en-us/microsoft-365/security/office-365-security/safe-links-policies-configure?view=o365-worldwide"
        }, {
          "text" : "T1204: User Execution",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/"
        }, {
          "text" : "T1204.001: Malicious Link",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/001/"
        }, {
          "text" : "T1204.002: Malicious File",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1204/002/"
        }, {
          "text" : "T1566: Phishing",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/"
        }, {
          "text" : "T1566.001: Spearphishing Attachment",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1566/001/"
        }, {
          "text" : "T1189: Drive-by Compromise",
          "rel" : "mitre",
          "href" : "https://attack.mitre.org/techniques/T1189/"
        } ],
        "steps" : [ {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Any product meeting the requirements outlined in this baseline policy may be used. If the agency uses Microsoft Defender, see the following implementation steps for [standard or strict preset security policy](defender.md#msdefender13v1-instructions) for additional guidance.\n\n\\[\\^1\\]: Note that B2B guest users and all anonymous users except for external users appear in Teams calls as *John Doe (Guest)*. To avoid potential confusion, true guest users are always referred to as B2B guest users in this document.\n\n# Appendix A - Custom Meeting Policies\n\nIf there is a legitimate business need, custom meeting policies can be defined with *specific* users assigned to them. For example, custom meeting policies can be configured with *specific* users having permission to record meetings. To allow specific users the ability to record meetings:",
          "uuid" : "eec06f55-aa00-48d4-807a-354576318008"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Sign in to the **Microsoft Teams admin center**.",
          "uuid" : "8b456d09-997b-40ad-a242-a0635adfc2a5"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Select **Meetings** \\> **Meeting policies**.",
          "uuid" : "e728e272-ab2c-42a3-b1f6-258db8d845b4"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Create a new policy by selecting **Add**. Give this new policy a name and appropriate description.",
          "uuid" : "6c8ffb36-d076-458d-90c3-8de725346161"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Under the **Recording \\& transcription** section, set **Cloud recording** to **On**.",
          "uuid" : "e6170e3c-110a-4c92-8e57-e5a5d1a26f0e"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Select **Save**.",
          "uuid" : "0f2a7629-94b3-4789-822d-def605adb3ad"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "After selecting **Save** , a table displays the set of policies. Select the row containing the new policy, then select **Manage users**.",
          "uuid" : "4f1054c3-7c92-49ed-b4ee-019019b742ce"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Assign the users who need the ability to record to this policy.",
          "uuid" : "d9ee1f3d-9dcd-4966-9c6b-6071a9fdac0c"
        }, {
          "props" : [ {
            "name" : "scuba-policy",
            "ns" : "http://comply0.com/ns/oscal",
            "value" : "MS.TEAMS.8.2v1"
          } ],
          "description" : "Select **Apply**.\n\n**`TLP:CLEAR`**",
          "uuid" : "74c77323-6a0a-4fc4-acc3-6133877bf1a6"
        } ],
        "description" : "Users may click on malicious links in Teams, leading to compromise or authorized data disclosure. Enabling user click tracking lets agencies know if a malicious link may have been visited after the fact to help tailor a response to a potential incident.",
        "props" : [ {
          "name" : "label",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "MS.TEAMS.8.2v1"
        }, {
          "name" : "method",
          "value" : "EXAMINE"
        }, {
          "name" : "policy-type",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "teams"
        }, {
          "name" : "criticality",
          "ns" : "http://cisa.gov/ns/oscal",
          "value" : "SHOULD"
        } ],
        "related-controls" : {
          "control-selections" : [ {
            "include-controls" : [ {
              "control-id" : "au-12",
              "statement-ids" : [ "au-12_smt.c" ]
            } ]
          } ]
        }
      } ]
    }
  }
}